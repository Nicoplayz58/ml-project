
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>AN√ÅLISIS SERIES DE TIEMPO DE BITCOIN &#8212; Machine Learning - Home Credit Problem</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'bitcoin';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Evaluaci√≥n de Modelos - Home Credit Default Risk" href="Modelos%20Home%20Credit.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Machine Learning - Home Credit Problem - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Machine Learning - Home Credit Problem - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Bienvenido a nuestro proyecto final üöÄ
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="EDA%20Home%20Credit%20P1.html">An√°lisis Exploratorio de Datos (EDA) - Home Credit Default Risk</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modelos%20Home%20Credit.html">Evaluaci√≥n de Modelos - Home Credit Default Risk</a></li>





<li class="toctree-l1 current active"><a class="current reference internal" href="#">AN√ÅLISIS SERIES DE TIEMPO DE BITCOIN</a></li>





























</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/nicoplayz58/home-credit" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/nicoplayz58/home-credit/issues/new?title=Issue%20on%20page%20%2Fbitcoin.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/bitcoin.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>AN√ÅLISIS SERIES DE TIEMPO DE BITCOIN</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">AN√ÅLISIS SERIES DE TIEMPO DE BITCOIN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#que-es-bitcoin">¬øQu√© es BITCOIN?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descripcion-de-los-datos">Descripci√≥n de los datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objetivo-del-analisis">Objetivo del an√°lisis</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-datos-bitcoin">An√°lisis exploratorio de datos - BITCOIN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-preliminar">An√°lisis preliminar</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-la-serie">Visualizaci√≥n de la serie</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-temporal">Visualizaci√≥n temporal</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-la-volatilidad-intradia">An√°lisis de la volatilidad intrad√≠a</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-del-precio-de-cierre-y-volumen-de-bitcoin">Interpretaci√≥n del Precio de Cierre y Volumen de Bitcoin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-estacionalidad-y-periodicidad-frecuencia-1-dia">An√°lisis de Estacionalidad y Periodicidad (Frecuencia: 1 d√≠a)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-de-anomalias">Detecci√≥n de Anomal√≠as</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-autocorrelacion">An√°lisis de autocorrelaci√≥n</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-tendencia">An√°lisis de tendencia</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-estacionaridad">An√°lisis de Estacionaridad</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformacion-de-datos">Transformaci√≥n de datos</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones-finales">Conclusiones finales</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-de-modelos-benchmark">Implementaci√≥n de Modelos Benchmark</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-prediccion-del-precio">Modelos Prediccion del Precio</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descripcion-de-la-funcion-de-preparacion-de-datos">Descripci√≥n de la Funci√≥n de Preparaci√≥n de Datos</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#k-nearest-neighbors-knn">K-Nearest Neighbors (KNN)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-resultados-del-modelo-knn-15m">An√°lisis de Resultados del Modelo KNN (15m)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#precio-real-vs-predicho">Precio Real vs. Predicho</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autocorrelacion-de-los-residuos-acf">Autocorrelaci√≥n de los Residuos (ACF)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histograma-de-los-residuos">Histograma de los Residuos</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algoritmo-de-optimizacion">Algoritmo de Optimizacion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#knn-kd-trees-ball-trees-faiss">KNN ‚Üí KD-Trees, Ball Trees, FAISS.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificador-naive-bayes">Clasificador Naive Bayes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-basado-en-el-teorema-de-bayes-asume-independencia-entre-caracteristicas-naive-para-calcular-probabilidades-de-pertenencia-a-cada-clase">Definici√≥n: Basado en el teorema de Bayes, asume independencia entre caracter√≠sticas (naive) para calcular probabilidades de pertenencia a cada clase.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-del-modelo-bayesian-ridge-15m">An√°lisis del Modelo Bayesian Ridge (15m)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-evaluacion">M√©tricas de Evaluaci√≥n</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion">Interpretaci√≥n:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graficos-de-evaluacion">Gr√°ficos de Evaluaci√≥n</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-y-siguientes-pasos">Conclusi√≥n y Siguientes Pasos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Algoritmo de Optimizacion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#naive-bayes-partial-fit-para-entrenamiento-por-lotes">Naive Bayes ‚Üí partial_fit() para entrenamiento por lotes.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-logistica-con-regularizacion-l1-l2">Regresi√≥n Log√≠stica (con regularizaci√≥n L1/L2)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-modelo-lineal-para-clasificacion-binaria-que-transforma-una-combinacion-lineal-de-inputs-mediante-la-funcion-sigmoide-para-estimar-probabilidades">Definici√≥n: Modelo lineal para clasificaci√≥n binaria que transforma una combinaci√≥n lineal de inputs mediante la funci√≥n sigmoide para estimar probabilidades.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ridge-regression">Ridge Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-tecnica-de-regularizacion-l2-para-modelos-lineales-que-penaliza-los-coeficientes-grandes-para-reducir-sobreajuste">Definici√≥n: T√©cnica de regularizaci√≥n L2 para modelos lineales que penaliza los coeficientes grandes para reducir sobreajuste.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lasso-regression">Lasso Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-tecnica-de-regularizacion-l1-que-no-solo-previene-sobreajuste-sino-que-tambien-realiza-seleccion-de-caracteristicas-al-forzar-coeficientes-a-cero">Definici√≥n: T√©cnica de regularizaci√≥n L1 que no solo previene sobreajuste sino que tambi√©n realiza selecci√≥n de caracter√≠sticas al forzar coeficientes a cero.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-optimizacion-ridge-vs-lasso">An√°lisis de Optimizaci√≥n: Ridge vs. Lasso</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-de-tiempos-de-entrenamiento">Comparaci√≥n de Tiempos de Entrenamiento</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Interpretaci√≥n:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-resultados-modelos-ridge-saga-vs-lasso-cv">An√°lisis de Resultados: Modelos Ridge (SAGA) vs Lasso (CV)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-rendimiento">M√©tricas de Rendimiento</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-resultados">Interpretaci√≥n de Resultados</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#precision-predictiva">Precisi√≥n Predictiva</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-residuos">An√°lisis de Residuos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ajuste-a-los-datos">Ajuste a los Datos</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones">Conclusiones</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">ALgoritmo de Optimizacion</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ridge-lasso-solver-optimizado-saga">Ridge/Lasso ‚Üí Solver optimizado saga.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-la-optimizacion-con-saga">An√°lisis de la Optimizaci√≥n con SAGA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observaciones">Observaciones</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-tree">Decision Tree</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-modelo-de-aprendizaje-supervisado-que-divide-recursivamente-el-espacio-de-caracteristicas-mediante-reglas-de-decision-binarias">Definici√≥n: Modelo de aprendizaje supervisado que divide recursivamente el espacio de caracter√≠sticas mediante reglas de decisi√≥n binarias.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-del-modelo-decision-tree-15m">An√°lisis del Modelo Decision Tree (15m)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuracion-del-modelo">Configuraci√≥n del modelo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">M√©tricas de Evaluaci√≥n</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-los-graficos">An√°lisis de los gr√°ficos</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest">Random Forest</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-metodo-de-ensemble-que-combina-multiples-arboles-de-decision-entrenados-en-subconjuntos-aleatorios-de-datos-y-caracteristicas">Definici√≥n: M√©todo de ensemble que combina m√∫ltiples √°rboles de decisi√≥n entrenados en subconjuntos aleatorios de datos y caracter√≠sticas.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-del-modelo-random-forest-rf">An√°lisis del modelo Random Forest (RF)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-del-modelo"><strong>M√©tricas del modelo</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-las-graficas"><strong>Interpretaci√≥n de las gr√°ficas</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#precio-real-vs-predicho-grafico-de-la-izquierda"><strong>1. Precio Real vs. Predicho</strong> (Gr√°fico de la izquierda)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#acf-de-los-residuos-grafico-del-centro"><strong>2. ACF de los residuos</strong> (Gr√°fico del centro)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#histograma-de-los-residuos-grafico-de-la-derecha"><strong>3. Histograma de los residuos</strong> (Gr√°fico de la derecha)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion"><strong>Conclusi√≥n</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost">XGBoost</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-algoritmo-de-boosting-que-combina-secuencialmente-modelos-debiles-normalmente-arboles-corrigiendo-los-errores-de-los-modelos-anteriores">Definici√≥n: Algoritmo de boosting que combina secuencialmente modelos d√©biles (normalmente √°rboles) corrigiendo los errores de los modelos anteriores.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluacion-del-modelo-xgboost">Evaluaci√≥n del Modelo XGBoost</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-con-otros-modelos">Comparaci√≥n con otros modelos</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Algoritmo de Optimizacion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost-tree-method-hist-y-early-stopping-rounds">XGBoost ‚Üí tree_method=‚Äôhist‚Äô y early_stopping_rounds.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Conclusiones</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost-optimizado">XGBoost Optimizado</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#svm-support-vector-machines">SVM (Support Vector Machines)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-algoritmo-que-encuentra-el-hiperplano-optimo-en-un-espacio-dimensional-alto-que-maximiza-el-margen-entre-clases">Definici√≥n: Algoritmo que encuentra el hiperplano √≥ptimo en un espacio dimensional alto que maximiza el margen entre clases.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Algoritmo de optimizacion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linearsvc-en-vez-de-svc-kernel-linear-rbf-con-random-fourier-features">LinearSVC en vez de SVC(kernel=‚Äôlinear‚Äô), RBF con Random Fourier Features</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados">Resultados</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-comparativo-de-modelos-de-regresion">An√°lisis Comparativo de Modelos de Regresi√≥n</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen-de-rendimiento">Resumen de Rendimiento</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#precision-predictiva-ordenados-de-mejor-a-peor">Precisi√≥n Predictiva (ordenados de mejor a peor)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eficiencia-computacional">Eficiencia Computacional</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">An√°lisis de Residuos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autocorrelacion-acf">Autocorrelaci√≥n (ACF)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distribucion-de-residuos">Distribuci√≥n de Residuos</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones-clave">Conclusiones Clave</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-para-volatilidad">Modelos para Volatilidad</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Descripcion de la funcion de Preparacion de Datos</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">K-Nearest Neighbors (KNN)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Algoritmo de Optimizacion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">KNN ‚Üí KD-Trees, Ball Trees, FAISS.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Clasificador Naive Bayes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Definici√≥n: Basado en el teorema de Bayes, asume independencia entre caracter√≠sticas (naive) para calcular probabilidades de pertenencia a cada clase.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Algoritmo de Optimizacion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Naive Bayes ‚Üí partial_fit() para entrenamiento por lotes.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Regresi√≥n Log√≠stica (con regularizaci√≥n L1/L2)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Definici√≥n: Modelo lineal para clasificaci√≥n binaria que transforma una combinaci√≥n lineal de inputs mediante la funci√≥n sigmoide para estimar probabilidades.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Ridge Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Definici√≥n: T√©cnica de regularizaci√≥n L2 para modelos lineales que penaliza los coeficientes grandes para reducir sobreajuste.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Lasso Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Definici√≥n: T√©cnica de regularizaci√≥n L1 que no solo previene sobreajuste sino que tambi√©n realiza selecci√≥n de caracter√≠sticas al forzar coeficientes a cero.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">ALgoritmo de Optimizacion</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Ridge/Lasso ‚Üí Solver optimizado saga.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">Decision Tree</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">Definici√≥n: Modelo de aprendizaje supervisado que divide recursivamente el espacio de caracter√≠sticas mediante reglas de decisi√≥n binarias.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">Random Forest</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">Definici√≥n: M√©todo de ensemble que combina m√∫ltiples √°rboles de decisi√≥n entrenados en subconjuntos aleatorios de datos y caracter√≠sticas.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">XGBoost</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">Definici√≥n: Algoritmo de boosting que combina secuencialmente modelos d√©biles (normalmente √°rboles) corrigiendo los errores de los modelos anteriores.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">Algoritmo de Optimizacion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">XGBoost ‚Üí tree_method=‚Äôhist‚Äô y early_stopping_rounds.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">SVM (Support Vector Machines)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id34">Definici√≥n: Algoritmo que encuentra el hiperplano √≥ptimo en un espacio dimensional alto que maximiza el margen entre clases.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id35">Algoritmo de optimizacion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id36">LinearSVC en vez de SVC(kernel=‚Äôlinear‚Äô), RBF con Random Fourier Features</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id37">Resultados</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analisis-series-de-tiempo-de-bitcoin">
<h1>AN√ÅLISIS SERIES DE TIEMPO DE BITCOIN<a class="headerlink" href="#analisis-series-de-tiempo-de-bitcoin" title="Link to this heading">#</a></h1>
<p>Por Eliana Fuentes, Nicol√°s Rodr√≠guez, Mar√≠a Camila Vargas.</p>
<section id="que-es-bitcoin">
<h2>¬øQu√© es BITCOIN?<a class="headerlink" href="#que-es-bitcoin" title="Link to this heading">#</a></h2>
<p>Bitcoin (BTC) es una criptomoneda, es decir, una moneda digital descentralizada que funciona sin la necesidad de un banco central. Se basa en tecnolog√≠a blockchain, un libro contable p√∫blico y distribuido donde se registran todas las transacciones. Su precio es altamente vol√°til debido a la oferta y demanda, noticias econ√≥micas, regulaciones y otros factores externos.</p>
</section>
<section id="descripcion-de-los-datos">
<h2>Descripci√≥n de los datos<a class="headerlink" href="#descripcion-de-los-datos" title="Link to this heading">#</a></h2>
<p>El dataset contiene datos financieros hist√≥ricos del mercado de Bitcoin con frecuencias de: 1 hora, 4 horas, 1dia y 15 minutos; cubriendo el periodo desde el 1 de enero de 2018 hasta 6 de febrero de 2025. Los datos permiten analizar el comportamiento de precios y vol√∫menes de Bitcoin, incluyendo tendencias, volatilidad y actividad del mercado. Contiene las siguientes variables:</p>
<ul class="simple">
<li><p>Precio de apertura (Open): El precio al que Bitcoin comenz√≥ a cotizar en un periodo determinado (15 min, 1h,  4h o 1d).</p></li>
<li><p>Precio de cierre (Close): El √∫ltimo precio registrado en ese mismo periodo.</p></li>
<li><p>M√°ximo y m√≠nimo (High &amp; Low): Los valores m√°s alto y m√°s bajo de Bitcoin en ese periodo.</p></li>
<li><p>Volumen (Volume): La cantidad total de Bitcoin negociado.</p></li>
<li><p>Quote asset volume: Volumen total de transacciones expresado en el activo cotizado (USD).</p></li>
<li><p>Number of trades: N√∫mero total de transacciones realizadas en el periodo.</p></li>
<li><p>Taker buy base asset volume: Volumen de compra por los compradores (takers) expresado en el activo base (Bitcoin).</p></li>
<li><p>Taker buy quote asset volume: Volumen de compra por los compradores (takers) expresado en el activo cotizado (USD).</p></li>
<li><p>Retorno (Return): La variaci√≥n porcentual del precio entre periodos consecutivos.</p></li>
<li><p>Volatilidad: Una medida de qu√© tan variable es el precio en un periodo de tiempo.</p></li>
</ul>
</section>
<section id="objetivo-del-analisis">
<h2>Objetivo del an√°lisis<a class="headerlink" href="#objetivo-del-analisis" title="Link to this heading">#</a></h2>
<p>El objetivo de este EDA es comprender la estructura de los datos de Bitcoin, identificar patrones temporales (tendencia, estacionalidad, ciclos), detectar anomal√≠as y preparar los datos para la aplicaci√≥n de modelos predictivos o de pron√≥stico.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="analisis-exploratorio-de-datos-bitcoin">
<h1>An√°lisis exploratorio de datos - BITCOIN<a class="headerlink" href="#analisis-exploratorio-de-datos-bitcoin" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="c1"># Paso 1: Verifica la disponibilidad de la GPU</span>
<span class="k">if</span> <span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">list_physical_devices</span><span class="p">(</span><span class="s1">&#39;GPU&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;GPU disponible&quot;</span><span class="p">)</span>
    <span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;/GPU:0&#39;</span>  <span class="c1"># Usa la primera GPU disponible</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;GPU no disponible, usando CPU&quot;</span><span class="p">)</span>
    <span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;/CPU:0&#39;</span>  <span class="c1"># Usa la CPU</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU disponible
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">adfuller</span><span class="p">,</span> <span class="n">acf</span><span class="p">,</span> <span class="n">pacf</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.seasonal</span> <span class="kn">import</span> <span class="n">seasonal_decompose</span>  <span class="c1"># Importaci√≥n corregida</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">RidgeClassifier</span><span class="p">,</span> <span class="n">Lasso</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="nn">xgb</span>
<span class="kn">import</span> <span class="nn">lime</span>
<span class="kn">import</span> <span class="nn">lime.lime_tabular</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KDTree</span><span class="p">,</span> <span class="n">BallTree</span>
<span class="kn">import</span> <span class="nn">faiss</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargat datos</span>

<span class="n">data_folder</span> <span class="o">=</span> <span class="s2">&quot;BTCBinance&quot;</span>

<span class="c1"># Archivos especiÃÅficos a leer</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;1d&quot;</span><span class="p">:</span> <span class="s2">&quot;btc_1d_data_2018_to_2025.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;4h&quot;</span><span class="p">:</span> <span class="s2">&quot;btc_4h_data_2018_to_2025.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;1h&quot;</span><span class="p">:</span> <span class="s2">&quot;btc_1h_data_2018_to_2025.csv&quot;</span><span class="p">,</span>
    <span class="s2">&quot;15m&quot;</span><span class="p">:</span> <span class="s2">&quot;btc_15m_data_2018_to_2025.csv&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Leer los datasets y procesarlos</span>
<span class="n">dfs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">files</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>  <span class="c1"># Ruta completa</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Open time&quot;</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;Open time&quot;</span><span class="p">)</span>  <span class="c1"># Leer con fecha como iÃÅndice</span>
    <span class="n">dfs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Open&quot;</span><span class="p">,</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span> <span class="s2">&quot;Low&quot;</span><span class="p">,</span> <span class="s2">&quot;Close&quot;</span><span class="p">,</span> <span class="s2">&quot;Volume&quot;</span><span class="p">]]</span>  <span class="c1"># Mantener columnas relevantes</span>
    
    <span class="c1"># Eliminar columna &quot;Ignore&quot; y seleccionar columnas relevantes</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ignore&quot;</span><span class="p">])</span>  <span class="c1"># Eliminar columna</span>
    <span class="n">dfs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Open&quot;</span><span class="p">,</span> <span class="s2">&quot;High&quot;</span><span class="p">,</span> <span class="s2">&quot;Low&quot;</span><span class="p">,</span> <span class="s2">&quot;Close&quot;</span><span class="p">,</span> <span class="s2">&quot;Volume&quot;</span><span class="p">]]</span>  <span class="c1"># Mantener columnas clave</span>
</pre></div>
</div>
</div>
</div>
<section id="analisis-preliminar">
<h2>An√°lisis preliminar<a class="headerlink" href="#analisis-preliminar" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Inspecci√≥n general.</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dfs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frecuencia: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dimensiones: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Primeras filas:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;√öltimas filas:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Valores faltantes por columna:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Frecuencia: 1d
Dimensiones: (2594, 5)
Primeras filas:
                Open      High       Low     Close        Volume
Open time                                                       
2018-01-01  13715.65  13818.55  12750.00  13380.00   8609.915844
2018-01-02  13382.16  15473.49  12890.02  14675.11  20078.092111
2018-01-03  14690.00  15307.56  14150.00  14919.51  15905.667639
2018-01-04  14919.51  15280.00  13918.04  15059.54  21329.649574
2018-01-05  15059.56  17176.24  14600.00  16960.39  23251.491125
√öltimas filas:
                 Open       High        Low      Close       Volume
Open time                                                          
2025-02-02  100635.66  101456.60   99747.59   99796.00   3149.62233
2025-02-03   97700.59   97782.79   91231.00   94495.21  20992.95572
2025-02-04  101328.51  101660.94  100743.33  101367.77   1910.35542
2025-02-05   97763.14   98930.44   97131.43   97589.30   8160.56795
2025-02-06   96612.44   99120.00   96430.78   98329.13   8315.06445
Valores faltantes por columna:
Open      0
High      0
Low       0
Close     0
Volume    0
dtype: int64
------------------------------
Frecuencia: 4h
Dimensiones: (15543, 5)
Primeras filas:
                         Open      High       Low     Close       Volume
Open time                                                               
2018-01-01 00:00:00  13715.65  13715.65  13155.38  13410.03  1676.204807
2018-01-01 04:00:00  13434.98  13818.55  13322.15  13570.35  1302.214836
2018-01-01 08:00:00  13569.98  13735.24  13001.13  13220.56  1319.755931
2018-01-01 12:00:00  13220.56  13330.00  12750.00  13247.00  1831.933153
2018-01-01 16:00:00  13247.00  13290.65  12940.00  13240.37  1092.337234
√öltimas filas:
                         Open      High       Low     Close      Volume
Open time                                                              
2025-02-05 08:00:00  97864.43  98256.00  97257.05  98198.00  3128.59694
2025-02-05 12:00:00  98198.00  99149.00  97734.69  98116.24  5192.00486
2025-02-05 16:00:00  98116.24  98277.02  96500.00  97370.00  4822.00148
2025-02-05 20:00:00  97370.00  97706.37  96155.00  96612.43  5817.81518
2025-02-06 00:00:00  96612.44  97493.07  96430.78  97355.67  2552.15194
Valores faltantes por columna:
Open      0
High      0
Low       0
Close     0
Volume    0
dtype: int64
------------------------------
Frecuencia: 1h
Dimensiones: (62111, 5)
Primeras filas:
                         Open      High       Low     Close      Volume
Open time                                                              
2018-01-01 00:00:00  13715.65  13715.65  13400.01  13529.01  443.356199
2018-01-01 01:00:00  13528.99  13595.89  13155.38  13203.06  383.697006
2018-01-01 02:00:00  13203.00  13418.43  13200.00  13330.18  429.064572
2018-01-01 03:00:00  13330.26  13611.27  13290.00  13410.03  420.087030
2018-01-01 04:00:00  13434.98  13623.29  13322.15  13601.01  340.807329
√öltimas filas:
                         Open      High       Low     Close      Volume
Open time                                                              
2025-02-05 20:00:00  97370.00  97706.37  96870.39  97323.39  1258.92036
2025-02-05 21:00:00  97323.40  97532.61  96769.23  96904.11  1234.05224
2025-02-05 22:00:00  96904.11  97047.89  96241.12  96445.63  2445.99875
2025-02-05 23:00:00  96445.64  96853.57  96155.00  96612.43   878.84383
2025-02-06 00:00:00  96612.44  96999.26  96430.78  96826.96   983.47440
Valores faltantes por columna:
Open      0
High      0
Low       0
Close     0
Volume    0
dtype: int64
------------------------------
Frecuencia: 15m
Dimensiones: (248397, 5)
Primeras filas:
                         Open      High       Low     Close      Volume
Open time                                                              
2018-01-01 00:00:00  13715.65  13715.65  13400.01  13556.15  123.616013
2018-01-01 00:15:00  13533.75  13550.87  13402.00  13521.12   98.136430
2018-01-01 00:30:00  13500.00  13545.37  13450.00  13470.41   79.904037
2018-01-01 00:45:00  13494.65  13690.87  13450.00  13529.01  141.699719
2018-01-01 01:00:00  13528.99  13571.74  13402.28  13445.63   72.537533
√öltimas filas:
                         Open      High       Low     Close     Volume
Open time                                                             
2025-02-05 23:00:00  96445.64  96824.80  96240.88  96714.02  357.74121
2025-02-05 23:15:00  96714.03  96853.57  96285.32  96327.51  163.73220
2025-02-05 23:30:00  96327.52  96641.06  96155.00  96584.95  211.05421
2025-02-05 23:45:00  96584.94  96665.81  96441.93  96612.43  146.31621
2025-02-06 00:00:00  96612.44  96815.63  96430.78  96732.14  279.01617
Valores faltantes por columna:
Open      0
High      0
Low       0
Close     0
Volume    0
dtype: int64
------------------------------
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Estad√≠sticas descriptivas</span>
<span class="k">for</span> <span class="n">freq</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dfs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">=== Estad√≠sticas descriptivas (</span><span class="si">{</span><span class="n">freq</span><span class="si">}</span><span class="s1">) ===&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Estad√≠sticas descriptivas (1d) ===
                Open           High            Low          Close  \
count    2594.000000    2594.000000    2594.000000    2594.000000   
mean    29057.847182   29743.249383   28327.995451   29090.193446   
std     23539.635421   24046.515394   23021.304519   23576.229505   
min      3211.710000    3276.500000    3156.260000    3211.720000   
25%      9067.985000    9261.240000    8765.000000    9068.840000   
50%     22712.950000   23252.895000   22257.575000   22741.115000   
75%     43484.365000   44293.657500   42487.500000   43527.390000   
max    106143.820000  108353.000000  105321.490000  106143.820000   

              Volume  
count    2594.000000  
mean    70821.588903  
std     80473.318599  
min      1521.537318  
25%     29769.803371  
50%     44833.178030  
75%     73702.302851  
max    760705.362783  

=== Estad√≠sticas descriptivas (4h) ===
                Open           High            Low          Close  \
count   15543.000000   15543.000000   15543.000000   15543.000000   
mean    29063.280668   29334.077876   28775.596838   29068.702379   
std     23531.883881   23732.467929   23322.094973   23537.982874   
min      3172.620000    3210.000000    3156.260000    3172.050000   
25%      9082.110000    9149.745000    8967.610000    9082.280000   
50%     22772.200000   22988.600000   22543.640000   22773.620000   
75%     43511.985000   43860.585000   43066.775000   43518.095000   
max    108239.190000  109588.000000  107093.330000  108239.190000   

              Volume  
count   15543.000000  
mean    11832.866537  
std     15081.813282  
min         5.887034  
25%      4276.162780  
50%      7066.940340  
75%     12596.614784  
max    284711.694213  

=== Estad√≠sticas descriptivas (1h) ===
                Open           High            Low          Close  \
count   62111.000000   62111.000000   62111.000000   62111.000000   
mean    29072.894562   29205.147342   28933.700827   29074.221833   
std     23533.108494   23630.688047   23432.206585   23534.568925   
min      3172.620000    3184.750000    3156.260000    3172.050000   
25%      9084.980000    9122.230000    9041.000000    9085.015000   
50%     22784.860000   22895.400000   22670.220000   22785.320000   
75%     43500.860000   43694.435000   43297.850000   43502.445000   
max    108320.000000  109588.000000  107780.510000  108320.010000   

              Volume  
count   62111.000000  
mean     2961.369397  
std      4146.849702  
min         0.000000  
25%       966.645698  
50%      1642.736260  
75%      3134.395999  
max    137207.188600  

=== Estad√≠sticas descriptivas (15m) ===
                Open           High            Low          Close  \
count  248397.000000  248397.000000  248397.000000  248397.000000   
mean    29074.231803   29138.729916   29007.225176   29074.566799   
std     23534.018801   23580.874018   23485.307403   23534.403528   
min      3166.110000    3174.780000    3156.260000    3167.070000   
25%      9086.540000    9103.730000    9066.380000    9086.620000   
50%     22794.360000   22848.560000   22737.490000   22794.370000   
75%     43500.540000   43600.000000   43397.050000   43501.020000   
max    108975.430000  109588.000000  108185.270000  108975.420000   

              Volume  
count  248397.000000  
mean      740.480636  
std      1131.293284  
min         0.000000  
25%       219.859070  
50%       388.084750  
75%       768.552930  
max     40371.405060  
</pre></div>
</div>
</div>
</div>
<p>El an√°lisis de los datos de Bitcoin entre enero de 2018 y febrero de 2025 revela una volatilidad extrema y un crecimiento notable, con precios oscilando entre <span class="math notranslate nohighlight">\(3,156.26 y \)</span>108,353.00. Durante este per√≠odo, el precio medio de cierre se situ√≥ en <span class="math notranslate nohighlight">\(29,090.19, con una elevada desviaci√≥n est√°ndar de \)</span>23,576.22, confirmando la importante variabilidad del mercado.</p>
<p>El volumen diario promedio alcanz√≥ las 70,821 unidades, con m√°ximos de 760,705 unidades en momentos de intensa actividad comercial. Los rendimientos diarios muestran un promedio de 0.14%, con ca√≠das extremas de hasta -39.50% y alzas de hasta 19.53% en un solo d√≠a, mientras que la mediana positiva del 0.07% sugiere una tendencia general alcista a pesar de la volatilidad.</p>
<p>La comparaci√≥n entre distintas frecuencias temporales (diaria, 4 horas y 1 hora) muestra consistencia en los valores medios y revela significativas fluctuaciones intradiarias, observ√°ndose adem√°s una distribuci√≥n desigual del volumen a lo largo del d√≠a.</p>
</section>
<section id="visualizacion-de-la-serie">
<h2>Visualizaci√≥n de la serie<a class="headerlink" href="#visualizacion-de-la-serie" title="Link to this heading">#</a></h2>
<section id="visualizacion-temporal">
<h3>Visualizaci√≥n temporal<a class="headerlink" href="#visualizacion-temporal" title="Link to this heading">#</a></h3>
<p>Con el objetivo de observar la tendencia general y posibles anomal√≠as.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gr√°fica de l√≠nea para el precio de cierre (solo fr de 1 d√≠a)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s2">&quot;Close&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Precio de Cierre (frecuencia: 15 min)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Precio de Cierre de Bitcoin (15 min)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Fecha&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Precio de Cierre (USD)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8a514f09a594977ee71a8f1dae84db03f88ee64fad06fdc89cf55c4d0e30c300.png" src="_images/8a514f09a594977ee71a8f1dae84db03f88ee64fad06fdc89cf55c4d0e30c300.png" />
</div>
</div>
<p>La gr√°fica del precio de cierre de Bitcoin en intervalos de 15 minutos, desde 2018 hasta principios de 2025, revela una serie de¬†ciclos de mercado completos, cada uno influenciado por eventos espec√≠ficos y factores externos. Durante este per√≠odo, Bitcoin experiment√≥ fases de consolidaci√≥n, ciclos alcistas significativos y correcciones prolongadas, reflejando su naturaleza vol√°til y din√°mica.</p>
<p>En¬†2018-2020, el precio se mantuvo en un rango relativamente bajo, con un m√≠nimo cercano a los $3,000 a finales de 2018, marcando un per√≠odo de consolidaci√≥n despu√©s del m√°ximo hist√≥rico de 2017. Este mercado bajista fue impulsado por la correcci√≥n posterior a la ‚Äúcripto-man√≠a‚Äù y la falta de adopci√≥n institucional en ese momento.</p>
<p>En¬†2021, se observ√≥ el primer ciclo alcista importante, con un r√°pido aumento desde¬†20,000 hasta superar los 60,000, impulsado por la adopci√≥n institucional (como las inversiones de Tesla y MicroStrategy), la expansi√≥n monetaria global debido a la pandemia de COVID-19, y el creciente inter√©s minorista. Sin embargo, este ciclo fue seguido por una correcci√≥n significativa y un segundo intento de alcanzar m√°ximos similares a finales de 2021.</p>
<p>El¬†2022¬†estuvo marcado por un mercado bajista prolongado, con el precio descendiendo gradualmente hasta estabilizarse alrededor de los $20,000 en 2023. Este per√≠odo estuvo influenciado por factores macroecon√≥micos adversos, como el aumento de las tasas de inter√©s y la inflaci√≥n, as√≠ como por problemas en el ecosistema cripto, como el colapso de FTX.</p>
<p>A partir de¬†finales de 2023 y durante 2024, se inici√≥ un nuevo ciclo alcista que super√≥ significativamente los m√°ximos anteriores, alcanzando m√°s de $100,000 a principios de 2025. Este ciclo podr√≠a estar relacionado con el evento de reducci√≥n de emisi√≥n (halving) programado para 2024, la mayor adopci√≥n de Bitcoin como reserva de valor, y la mejora de la infraestructura del ecosistema cripto.</p>
<p>En resumen, esta gr√°fica no solo muestra la evoluci√≥n del precio de Bitcoin, sino que tambi√©n refleja la influencia de factores externos y la maduraci√≥n del ecosistema cripto a lo largo del tiempo.</p>
</section>
<section id="analisis-de-la-volatilidad-intradia">
<h3>An√°lisis de la volatilidad intrad√≠a<a class="headerlink" href="#analisis-de-la-volatilidad-intradia" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcular los retornos porcentuales y la volatilidad (desviaci√≥n est√°ndar de los retornos)</span>
<span class="k">for</span> <span class="n">freq</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">dfs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Return&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>  <span class="c1"># Retornos porcentuales</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Volatility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Return&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>  <span class="c1"># Volatilidad (20 per√≠odos)</span>

<span class="c1"># Visualizar la volatilidad para la frecuencia de 15 minutos</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s1">&#39;Volatility&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Volatilidad (15 min)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Volatilidad del Precio de Bitcoin (15 minutos)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Fecha&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Volatilidad&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8b67e2a118a37cc35e5ca71b09a87dbc57faa4b64c1eecb0ff33963f7bda94a2.png" src="_images/8b67e2a118a37cc35e5ca71b09a87dbc57faa4b64c1eecb0ff33963f7bda94a2.png" />
</div>
</div>
<p>La gr√°fica de volatilidad muestra c√≥mo la variabilidad del precio de Bitcoin ha cambiado a lo largo del tiempo en intervalos de 15 minutos. Se observan picos de volatilidad que coinciden con eventos importantes en el mercado. Por ejemplo, en 2020, el halving de Bitcoin (mayo 2020) y la incertidumbre generada por la pandemia de COVID-19 provocaron un aumento significativo en la volatilidad. Durante 2021, la volatilidad tambi√©n aument√≥ debido al r√°pido crecimiento del precio, impulsado por la adopci√≥n institucional y el inter√©s minorista.</p>
<p>En 2022, la ca√≠da del precio y eventos como el colapso de FTX (noviembre 2022) generaron nuevos picos de volatilidad, reflejando la desconfianza en el ecosistema cripto. Por otro lado, los per√≠odos de baja volatilidad, como en 2019 o 2023, suelen indicar momentos de consolidaci√≥n o estabilidad en el mercado. Este an√°lisis de volatilidad es crucial para entender los movimientos bruscos del precio y c√≥mo reacciona el mercado ante eventos espec√≠ficos.</p>
</section>
<section id="interpretacion-del-precio-de-cierre-y-volumen-de-bitcoin">
<h3>Interpretaci√≥n del Precio de Cierre y Volumen de Bitcoin<a class="headerlink" href="#interpretacion-del-precio-de-cierre-y-volumen-de-bitcoin" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Crear una gr√°fica con dos ejes (precio y volumen)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Eje izquierdo: Precio de cierre</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Precio de Cierre (15 min)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Fecha&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Precio de Cierre (USD)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>

<span class="c1"># Eje derecho: Volumen</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s1">&#39;Volume&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Volumen (15 min)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Volumen&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Precio de Cierre y Volumen de Bitcoin (15 minutos)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3bb3e60dff7333868cf5942b323640a67528f439598ced4aee195ff9eaa428cd.png" src="_images/3bb3e60dff7333868cf5942b323640a67528f439598ced4aee195ff9eaa428cd.png" />
</div>
</div>
<p>La gr√°fica que combina el precio de cierre y el volumen de transacciones permite analizar la relaci√≥n entre ambos. Los picos de precio acompa√±ados de un aumento en el volumen sugieren que el movimiento est√° respaldado por una mayor actividad comercial. Por ejemplo, en 2021, los m√°ximos hist√≥ricos de Bitcoin (alrededor de 64,000 en abril  y 69,000 en noviembre) coincidieron con aumentos significativos en el volumen, lo que indica una fuerte participaci√≥n del mercado. Por el contrario, en 2022, la ca√≠da del precio tambi√©n estuvo acompa√±ada de un volumen elevado, especialmente durante el colapso de FTX, lo que refleja una intensa actividad de venta. En algunos casos, se observan movimientos de precio con bajo volumen, lo que podr√≠a indicar una falta de solidez en el movimiento o posibles manipulaciones del mercado. Esta relaci√≥n entre precio y volumen es crucial para entender la din√°mica del mercado y confirmar la validez de los movimientos de precio.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definir eventos clave</span>
<span class="n">eventos</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Halving 2020&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-05-11&quot;</span><span class="p">,</span>
    <span class="s2">&quot;M√°ximo hist√≥rico 2021&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-04-14&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Colapso de FTX&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-11-11&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Halving 2024&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-04-20&quot;</span>  <span class="c1"># Fecha estimada</span>
<span class="p">}</span>

<span class="c1"># Graficar precio de cierre con eventos marcados</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s1">&#39;Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Precio de Cierre (15 min)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">evento</span><span class="p">,</span> <span class="n">fecha</span> <span class="ow">in</span> <span class="n">eventos</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">fecha</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">evento</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Precio de Cierre de Bitcoin con Eventos Clave (15 minutos)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Fecha&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Precio de Cierre (USD)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1fff36bc11fe96918f647f26f2af8b2dd6de57778684f5ae561831736bb0353f.png" src="_images/1fff36bc11fe96918f647f26f2af8b2dd6de57778684f5ae561831736bb0353f.png" />
</div>
</div>
<p>La gr√°fica que incluye eventos clave muestra c√≥mo estos han influido en el comportamiento del precio de Bitcoin. El halving de 2020 marc√≥ el inicio de un ciclo alcista, mientras que el colapso de FTX en 2022 gener√≥ una ca√≠da brusca en el precio. El pr√≥ximo halving de 2024 podr√≠a marcar el inicio de un nuevo ciclo alcista. Estos eventos clave son fundamentales para entender los movimientos del precio y la din√°mica del mercado de Bitcoin.</p>
</section>
<section id="analisis-de-estacionalidad-y-periodicidad-frecuencia-1-dia">
<h3>An√°lisis de Estacionalidad y Periodicidad (Frecuencia: 1 d√≠a)<a class="headerlink" href="#analisis-de-estacionalidad-y-periodicidad-frecuencia-1-dia" title="Link to this heading">#</a></h3>
<p>Descomposici√≥n de la serie en tendencia, estacionalidad y residuales.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.seasonal</span> <span class="kn">import</span> <span class="n">seasonal_decompose</span>

<span class="c1"># Descomposici√≥n de la serie temporal para la frecuencia diaria</span>
<span class="n">freq</span> <span class="o">=</span> <span class="s2">&quot;1d&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="n">freq</span><span class="p">]</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Close&quot;</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;multiplicative&quot;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">365</span><span class="p">)</span>  <span class="c1"># Periodo aproximado de 1 a√±o</span>

<span class="c1"># Graficar los componentes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Close&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Serie original&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">trend</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Tendencia&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">seasonal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Estacionalidad&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Residuo&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e3e9aa0210e185306911f14ee7a5391ee5d944006c41157cca9e262be47b11d1.png" src="_images/e3e9aa0210e185306911f14ee7a5391ee5d944006c41157cca9e262be47b11d1.png" />
</div>
</div>
<p>En el primer panel, y como ya se vio anteriormente, la serie original muestra el precio de Bitcoin con su alta volatilidad, comenzando alrededor de <span class="math notranslate nohighlight">\(10,000 en 2018, experimentando dos ciclos alcistas significativos (2021 y 2024-2025), con el precio m√°ximo superando los \)</span>100,000 a principios de 2025.</p>
<p>El segundo panel muestra la tendencia subyacente, que filtra las fluctuaciones a corto plazo, revelando tres fases principales: un per√≠odo estable entre 2018-2020, un ciclo alcista y bajista entre 2021-2022, y una nueva fase alcista desde 2023 hasta 2025, sugiriendo ciclos aproximadamente de 4 a√±os.</p>
<p>El tercer panel presenta el componente estacional, que muestra patrones recurrentes dentro de cada a√±o con fluctuaciones entre 0.85 y 1.15, indicando que Bitcoin tiende a tener per√≠odos predecibles de mayor y menor actividad que se repiten anualmente.</p>
<p>Finalmente, el componente residual en el cuarto panel captura las fluctuaciones irregulares no explicadas por la tendencia o estacionalidad, mostrando la naturaleza impredecible del mercado de Bitcoin, con momentos de alta volatilidad inexplicable, especialmente durante 2019-2020 y 2021-2022.</p>
</section>
<section id="deteccion-de-anomalias">
<h3>Detecci√≥n de Anomal√≠as<a class="headerlink" href="#deteccion-de-anomalias" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Detecci√≥n de anomal√≠as</span>
<span class="c1"># Usamos el m√©todo de desviaci√≥n est√°ndar para detectar outliers</span>
<span class="n">residuals</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">resid</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>  <span class="c1"># Residuos de la descomposici√≥n</span>
<span class="n">mean_residual</span> <span class="o">=</span> <span class="n">residuals</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_residual</span> <span class="o">=</span> <span class="n">residuals</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">outliers</span> <span class="o">=</span> <span class="n">residuals</span><span class="p">[(</span><span class="n">residuals</span> <span class="o">&gt;</span> <span class="n">mean_residual</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">std_residual</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">residuals</span> <span class="o">&lt;</span> <span class="n">mean_residual</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">std_residual</span><span class="p">)]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">residuals</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Residuos&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">outliers</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">outliers</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Outliers&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Detecci√≥n de anomal√≠as en los residuos, frecuencia: 1 dia&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Fecha&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Residuos&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8f9baf646d12d13bb8a231c133216b24f054314bbbc60c7474148c29f4827a10.png" src="_images/8f9baf646d12d13bb8a231c133216b24f054314bbbc60c7474148c29f4827a10.png" />
</div>
</div>
<p>En esta gr√°fica, los residuos de la descomposici√≥n de la serie temporal se muestran en azul, y los valores at√≠picos (outliers) se resaltan en rojo.</p>
<p>La detecci√≥n de anomal√≠as en los residuos de la serie temporal de Bitcoin con frecuencia diaria revela eventos extremos que han impactado significativamente el mercado. Estos outliers, que se desv√≠an m√°s de 2 desviaciones est√°ndar de la media, est√°n asociados con eventos clave que han influido en el comportamiento del precio de Bitcoin.</p>
<p>Los outliers detectados en los residuos reflejan la naturaleza altamente vol√°til del mercado de Bitcoin y su sensibilidad a eventos externos como los ya mencionados anteriormente. Estos eventos no solo generan movimientos bruscos en el precio, sino que tambi√©n tienen un impacto duradero en la confianza del mercado y la adopci√≥n de Bitcoin.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 4.1 Diagramas de caja por periodo (meses)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s2">&quot;Close&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribuci√≥n de precios de cierre de Bitcoin por mes&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Mes&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Precio de cierre (USD)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/409057fb9a3f47fba4bafcb9fe78327101fc7e91385e7d3371aeecb766a8ffd6.png" src="_images/409057fb9a3f47fba4bafcb9fe78327101fc7e91385e7d3371aeecb766a8ffd6.png" />
</div>
</div>
<p>El an√°lisis de la distribuci√≥n de precios de cierre de Bitcoin revela patrones significativos de volatilidad y estacionalidad a lo largo del a√±o. Los datos muestran una clara tendencia hacia mayor volatilidad y precios extremadamente altos en los meses de invierno (diciembre, enero y febrero), donde se observan valores at√≠picos superiores a los <span class="math notranslate nohighlight">\(100,000 USD. En contraste, el per√≠odo de mediados de a√±o (junio a septiembre) presenta rangos m√°s estrechos, sugiriendo fases de relativa estabilidad en el mercado. Las medianas mensuales oscilan principalmente entre \)</span>20,000 y $30,000 USD, pero los rangos intercuart√≠licos m√°s amplios en marzo y abril indican per√≠odos de mayor incertidumbre y dispersi√≥n en los precios.</p>
</section>
<section id="analisis-de-autocorrelacion">
<h3>An√°lisis de autocorrelaci√≥n<a class="headerlink" href="#analisis-de-autocorrelacion" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Para la serie original - Frecuencia 15min</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>  <span class="c1"># Figura m√°s grande</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="c1"># Ajustamos a 192 lags (que equivale a 2 d√≠as para datos de 15min: 24h * 4 observaciones/hora * 2 d√≠as)</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s2">&quot;Close&quot;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">192</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Autocorrelaci√≥n (ACF) - Precio de Cierre (Original)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lags (per√≠odos de 15 minutos)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">plot_pacf</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s2">&quot;Close&quot;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">192</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Autocorrelaci√≥n Parcial (PACF) - Precio de Cierre (Original)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lags (per√≠odos de 15 minutos)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/faabc4fbdc56bb4047539a28c05d0af6f5648d8ebc4e39725454de2be96e8837.png" src="_images/faabc4fbdc56bb4047539a28c05d0af6f5648d8ebc4e39725454de2be96e8837.png" />
</div>
</div>
<p>El gr√°fico de Autocorrelaci√≥n (ACF) del precio de cierre de Bitcoin muestra autocorrelaciones extremadamente altas y persistentes (cercanas a 1) en todos los rezagos analizados, sin mostrar disminuci√≥n significativa incluso en rezagos distantes. Este patr√≥n es caracter√≠stico de una serie temporal fuertemente no estacionaria, como una caminata aleatoria o una serie con tendencia determinista. Esta persistencia total de la autocorrelaci√≥n confirma la necesidad de aplicar diferenciaci√≥n para lograr estacionariedad.</p>
<p>El gr√°fico de Autocorrelaci√≥n Parcial (PACF) muestra un pico significativo √∫nicamente en el primer rezago, seguido de valores que caen dentro de las bandas de significancia estad√≠stica. Esto sugiere que, controlando por el efecto del valor inmediatamente anterior, los rezagos adicionales no aportan informaci√≥n significativa.</p>
</section>
<section id="analisis-de-tendencia">
<h3>An√°lisis de tendencia<a class="headerlink" href="#analisis-de-tendencia" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.holtwinters</span> <span class="kn">import</span> <span class="n">ExponentialSmoothing</span>

<span class="c1"># Aplicar suavizamiento exponencial</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s2">&quot;Close&quot;</span><span class="p">],</span> <span class="n">trend</span><span class="o">=</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">damped</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>  <span class="c1"># Ajustar el nivel de suavizado</span>

<span class="c1"># Graficar el precio original y el suavizado</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s2">&quot;Close&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Precio de Cierre (15 min)&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">fit</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Tendencia (suavizamiento exponencial)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Precio de Cierre de Bitcoin con Suavizamiento Exponencial&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Fecha&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Precio de Cierre (USD)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\mcvar\AppData\Local\Temp\ipykernel_32972\3949336284.py:4: FutureWarning: the &#39;damped&#39; keyword is deprecated, use &#39;damped_trend&#39; instead.
  model = ExponentialSmoothing(dfs[&quot;15m&quot;][&quot;Close&quot;], trend=&quot;add&quot;, seasonal=None, damped=True)
c:\Users\mcvar\anaconda3\envs\ml_venv\lib\site-packages\statsmodels\tsa\base\tsa_model.py:473: ValueWarning: A date index has been provided, but it has no associated frequency information and so will be ignored when e.g. forecasting.
  self._init_dates(dates, freq)
c:\Users\mcvar\anaconda3\envs\ml_venv\lib\site-packages\statsmodels\tsa\holtwinters\model.py:918: ConvergenceWarning: Optimization failed to converge. Check mle_retvals.
  warnings.warn(
</pre></div>
</div>
<img alt="_images/d93367c66842384cc3c8b3896685f1c6b7acc137c516be62acf248896949c01e.png" src="_images/d93367c66842384cc3c8b3896685f1c6b7acc137c516be62acf248896949c01e.png" />
</div>
</div>
<p>Esta gr√°fica confirma lo visto anteriormente, el precio de Bitcoin ha mostrado ciclos de mercado claros cada cuatro a√±os, coincidiendo con los halvings. Tras una consolidaci√≥n entre 2018 y 2020, experiment√≥ un alza significativa en 2021, seguida de una correcci√≥n en 2022. A partir de 2023, inici√≥ un nuevo ciclo alcista, alcanzando m√°ximos hist√≥ricos en 2025. Esto confirma la tendencia alcista a largo plazo de Bitcoin, a pesar de su volatilidad.</p>
</section>
<section id="analisis-de-estacionaridad">
<h3>An√°lisis de Estacionaridad<a class="headerlink" href="#analisis-de-estacionaridad" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prueba de Dickey-Fuller aumentada (ADF)</span>

<span class="k">def</span> <span class="nf">test_stationarity</span><span class="p">(</span><span class="n">timeseries</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Resultados de la prueba de Dickey-Fuller:&#39;</span><span class="p">)</span>
    <span class="n">dftest</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">timeseries</span><span class="p">,</span> <span class="n">autolag</span><span class="o">=</span><span class="s1">&#39;AIC&#39;</span><span class="p">)</span>
    <span class="n">dfoutput</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dftest</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Estad√≠stico&#39;</span><span class="p">,</span> <span class="s1">&#39;p-valor&#39;</span><span class="p">,</span> <span class="s1">&#39;#Lags&#39;</span><span class="p">,</span> <span class="s1">&#39;Observaciones&#39;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dftest</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">dfoutput</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Valor cr√≠tico (</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dfoutput</span><span class="p">)</span>

<span class="n">test_stationarity</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s2">&quot;Close&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados de la prueba de Dickey-Fuller:
Estad√≠stico                 0.304424
p-valor                     0.977547
#Lags                      84.000000
Observaciones          248312.000000
Valor cr√≠tico (1%)         -3.430376
Valor cr√≠tico (5%)         -2.861552
Valor cr√≠tico (10%)        -2.566776
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Estos resultados de la prueba de Dickey-Fuller para la serie temporal del precio de Bitcoin indican claramente que la serie no es estacionaria. El estad√≠stico de prueba de -0.040965 est√° muy por encima de todos los valores cr√≠ticos, incluso del menos estricto al 10% (-2.566776). El p-valor extremadamente alto de 0.977547 confirma que no podemos rechazar la hip√≥tesis nula de que existe una ra√≠z unitaria en la serie.</p>
<p>Esta prueba confirma formalmente lo que suger√≠an los gr√°ficos de autocorrelaci√≥n: el precio de Bitcoin presenta una tendencia persistente y no revierte a una media constante a lo largo del tiempo. Para realizar an√°lisis estad√≠sticos adecuados o construir modelos predictivos, ser√≠a necesario transformar la serie mediante diferenciaci√≥n u otros m√©todos para conseguir estacionariedad. Este resultado es t√≠pico en series de precios de activos financieros y coincide con la teor√≠a de que los mercados financieros suelen seguir un comportamiento similar al de un paseo aleatorio.</p>
</section>
</section>
<section id="transformacion-de-datos">
<h2>Transformaci√≥n de datos<a class="headerlink" href="#transformacion-de-datos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s2">&quot;Close_diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s2">&quot;Close&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">test_stationarity</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s2">&quot;Close_diff&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>

<span class="c1"># Graficar ACF Y PACF de la serie diferenciada</span>

<span class="c1"># Para la serie diferenciada</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>  <span class="c1"># Figura m√°s grande</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s2">&quot;Close_diff&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">192</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> 
         <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mf">1.96</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s2">&quot;Close_diff&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())),</span> 
           <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">1.96</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s2">&quot;Close_diff&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())),</span> 
           <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Autocorrelaci√≥n (ACF) - Serie Diferenciada&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lags (per√≠odos de 15 minutos)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;ACF&#39;</span><span class="p">,</span> <span class="s1">&#39;Media (0)&#39;</span><span class="p">,</span> <span class="s1">&#39;Banda de significancia (95%)&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">plot_pacf</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s2">&quot;Close_diff&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">192</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
          <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mf">1.96</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s2">&quot;Close_diff&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())),</span> 
           <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">1.96</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">][</span><span class="s2">&quot;Close_diff&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())),</span> 
           <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Autocorrelaci√≥n Parcial (PACF) - Serie Diferenciada&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lags (per√≠odos de 15 minutos)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;PACF&#39;</span><span class="p">,</span> <span class="s1">&#39;Media (0)&#39;</span><span class="p">,</span> <span class="s1">&#39;Banda de significancia (95%)&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados de la prueba de Dickey-Fuller:
Estad√≠stico               -53.495730
p-valor                     0.000000
#Lags                      85.000000
Observaciones          248310.000000
Valor cr√≠tico (1%)         -3.430376
Valor cr√≠tico (5%)         -2.861552
Valor cr√≠tico (10%)        -2.566776
dtype: float64
</pre></div>
</div>
<img alt="_images/a276d04eb780c3b1949c2f61e700cf759563b5df9d55cffcb1477c4f81524b24.png" src="_images/a276d04eb780c3b1949c2f61e700cf759563b5df9d55cffcb1477c4f81524b24.png" />
</div>
</div>
<p>Los resultados de la prueba de Dickey-Fuller para la serie diferenciada del precio de Bitcoin muestran un cambio dr√°stico respecto a la serie original. El estad√≠stico de prueba de -53.495730 es significativamente menor que todos los valores cr√≠ticos (-3.430376 al 1%, -2.861552 al 5% y -2.566776 al 10%), y el p-valor extremadamente bajo de 0.000000 indica que podemos rechazar con gran confianza la hip√≥tesis nula de no estacionariedad. Esto confirma que la serie diferenciada es estacionaria, lo que significa que sus propiedades estad√≠sticas (como la media y la varianza) se mantienen constantes a lo largo del tiempo.</p>
<p>La diferenciaci√≥n, que calcula los cambios en el precio en intervalos de 15 minutos en lugar de los precios absolutos, ha eliminado la tendencia persistente y ha estabilizado la serie.</p>
<p>An√°lisis de las gr√°ficas ACF y PACF:</p>
<p>Las gr√°ficas ACF y PACF de la serie diferenciada muestran que no hay autocorrelaciones significativas en ning√∫n rezago (excepto el lag 0), ya que todos los valores est√°n dentro de las bandas de significancia del 95%. Esto sugiere que la serie diferenciada se comporta como un ruido blanco, indicando que el proceso de diferenciaci√≥n ha eliminado efectivamente cualquier estructura de autocorrelaci√≥n, tendencia o estacionalidad que pudiera haber existido en la serie original.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="conclusiones-finales">
<h1>Conclusiones finales<a class="headerlink" href="#conclusiones-finales" title="Link to this heading">#</a></h1>
<p>El an√°lisis exploratorio de datos (EDA) del precio de cierre de Bitcoin ha revelado una serie de patrones y caracter√≠sticas clave que son fundamentales para entender su comportamiento:</p>
<p>Tendencia General: Bitcoin ha mostrado una tendencia alcista a largo plazo, con ciclos de mercado claros que coinciden con eventos importantes como halvings y crisis en el ecosistema cripto.</p>
<p>Volatilidad: El precio de Bitcoin es altamente vol√°til, con fluctuaciones significativas en per√≠odos cortos. Esta volatilidad est√° influenciada por eventos externos, como noticias econ√≥micas y cambios regulatorios.</p>
<p>Estacionalidad: Se han identificado patrones recurrentes en los datos, especialmente en ciclos anuales. Estos patrones sugieren que Bitcoin tiende a tener per√≠odos predecibles de mayor y menor actividad.</p>
<p>Anomal√≠as: Los valores at√≠picos detectados en los residuos est√°n asociados con eventos extremos, como el colapso de FTX en 2022. Estos eventos tienen un impacto significativo en el precio y la confianza del mercado.</p>
<p>Estacionariedad: La serie original no es estacionaria, pero la diferenciaci√≥n ha permitido lograr estacionariedad, lo que es crucial para la aplicaci√≥n de modelos predictivos.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="implementacion-de-modelos-benchmark">
<h1>Implementaci√≥n de Modelos Benchmark<a class="headerlink" href="#implementacion-de-modelos-benchmark" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="k">def</span> <span class="nf">prepare_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">lookback</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="c1"># Crear caracter√≠sticas t√©cnicas</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Returns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MA_10&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MA_20&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Volatility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Returns&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">lookback</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    
    <span class="c1"># Agregar retardos (lags)</span>
    <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lookback</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Close_lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span>
    
    <span class="c1"># Definir el target</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="n">horizon</span><span class="p">)</span>
    
    <span class="c1"># Eliminar NaN values</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    
    <span class="c1"># Definir caracter√≠sticas expl√≠citamente (evitar columnas no relacionadas)</span>
    <span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Returns&#39;</span><span class="p">,</span> <span class="s1">&#39;MA_10&#39;</span><span class="p">,</span> <span class="s1">&#39;MA_20&#39;</span><span class="p">,</span> <span class="s1">&#39;Volatility&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lookback</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Close_lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="c1"># Separar caracter√≠sticas y target</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Target&#39;</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>  <span class="c1"># Retornar X sin escalar para aplicar scaler despu√©s de dividir</span>

<span class="c1"># Preparar datos</span>
<span class="n">X_15m</span><span class="p">,</span> <span class="n">y_15m</span> <span class="o">=</span> <span class="n">prepare_data</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

<span class="c1"># Dividir en train y test (sin shuffle para series de tiempo)</span>
<span class="n">X_train_15m</span><span class="p">,</span> <span class="n">X_test_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">,</span> <span class="n">y_test_15m</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_15m</span><span class="p">,</span> <span class="n">y_15m</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Escalar despu√©s de dividir para evitar data leakage</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train_15m_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">)</span>
<span class="n">X_test_15m_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test_15m</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modelos-prediccion-del-precio">
<h1>Modelos Prediccion del Precio<a class="headerlink" href="#modelos-prediccion-del-precio" title="Link to this heading">#</a></h1>
<section id="descripcion-de-la-funcion-de-preparacion-de-datos">
<h2>Descripci√≥n de la Funci√≥n de Preparaci√≥n de Datos<a class="headerlink" href="#descripcion-de-la-funcion-de-preparacion-de-datos" title="Link to this heading">#</a></h2>
<p>La funci√≥n <code class="docutils literal notranslate"><span class="pre">preparar_datos()</span></code> tiene como objetivo principal la preparaci√≥n del conjunto de datos para ser utilizado en modelos de regresi√≥n. A continuaci√≥n, se describen los pasos clave que realiza:</p>
<ol class="arabic simple">
<li><p><strong>Carga de Datos</strong>: La funci√≥n recibe el DataFrame con la informaci√≥n hist√≥rica de BTC-USD y selecciona las variables de inter√©s.</p></li>
<li><p><strong>Limpieza de Datos</strong>: Se eliminan valores nulos o at√≠picos, asegurando la calidad de los datos antes de la modelaci√≥n.</p></li>
<li><p><strong>Generaci√≥n de Caracter√≠sticas</strong>: Se crean nuevas variables predictoras basadas en retardos temporales (lags) y estad√≠sticas de ventanas m√≥viles.</p></li>
<li><p><strong>Divisi√≥n en Conjuntos de Entrenamiento y Prueba</strong>: Se separan los datos en conjuntos de entrenamiento (<code class="docutils literal notranslate"><span class="pre">X_train</span></code>, <code class="docutils literal notranslate"><span class="pre">y_train</span></code>) y prueba (<code class="docutils literal notranslate"><span class="pre">X_test</span></code>, <code class="docutils literal notranslate"><span class="pre">y_test</span></code>).</p></li>
<li><p><strong>Escalado de Variables</strong>: Se normalizan las variables predictoras para mejorar la estabilidad num√©rica de los modelos.</p></li>
</ol>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="k-nearest-neighbors-knn">
<h1>K-Nearest Neighbors (KNN)<a class="headerlink" href="#k-nearest-neighbors-knn" title="Link to this heading">#</a></h1>
<p>Definici√≥n: Modelo de aprendizaje supervisado no param√©trico que clasifica nuevas observaciones bas√°ndose en la mayor√≠a de votos de sus <span class="math notranslate nohighlight">\(k\)</span> vecinos m√°s cercanos en el espacio de caracter√≠sticas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>

<span class="c1"># Inicializar el modelo con hiperpar√°metros ajustados</span>
<span class="n">knn_15m</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> 

<span class="c1"># Entrenar el modelo</span>
<span class="n">knn_15m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">)</span>

<span class="c1"># Hacer predicciones</span>
<span class="n">y_pred_15m</span> <span class="o">=</span> <span class="n">knn_15m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_15m</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="c1"># Inicializar el modelo KNN</span>
<span class="n">knn_15m</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Entrenar el modelo</span>
<span class="n">knn_15m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">)</span>

<span class="c1"># Predicciones</span>
<span class="n">y_pred_15m</span> <span class="o">=</span> <span class="n">knn_15m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_15m</span><span class="p">)</span>

<span class="c1"># Calcular residuos</span>
<span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test_15m</span> <span class="o">-</span> <span class="n">y_pred_15m</span>

<span class="c1"># M√âTRICAS DE EVALUACI√ìN</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_15m</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_15m</span><span class="p">))</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_15m</span><span class="p">)</span>

<span class="c1"># Prueba de Ljung-Box (autocorrelaci√≥n de residuos)</span>
<span class="n">ljung_box_result</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ljung_box_pvalue</span> <span class="o">=</span> <span class="n">ljung_box_result</span><span class="p">[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Prueba de Jarque-Bera (normalidad de residuos)</span>
<span class="n">jb_result</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
<span class="n">jb_stat</span><span class="p">,</span> <span class="n">jb_pvalue</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">jb_result</span>  <span class="c1"># Extraer solo los valores relevantes</span>

<span class="c1"># Crear tabla de resultados</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mape</span><span class="p">],</span>
    <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">rmse</span><span class="p">],</span>
    <span class="s1">&#39;R¬≤&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">r2</span><span class="p">],</span>
    <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">ljung_box_pvalue</span><span class="p">],</span>
    <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">jb_pvalue</span><span class="p">]</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> RESULTADOS DEL MODELO KNN (15m):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>

<span class="c1"># GRAFICAR RESULTADOS</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1">#  Precio real vs Predicho</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test_15m</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Real&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred_15m</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Predicho&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;üìà Precio Real vs. Predicho&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1">#  Autocorrelaci√≥n de residuos (ACF)</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot; ACF de los residuos&quot;</span><span class="p">)</span>

<span class="c1"># Histograma de los residuos</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot; Histograma de los residuos&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> RESULTADOS DEL MODELO KNN (15m):
       MAPE          RMSE        R¬≤  Ljung-Box p-value  Jarque-Bera p-value
0  0.055993  12304.781637  0.659692                0.0                  0.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/70/380whh_x6t31tncscvq5h0qr0000gn/T/ipykernel_97983/1950521725.py:64: UserWarning: Glyph 128200 (\N{CHART WITH UPWARDS TREND}) missing from font(s) DejaVu Sans.
  plt.tight_layout()
/Users/elianafuentes/miniconda3/envs/ml_venv/lib/python3.9/site-packages/IPython/core/pylabtools.py:152: UserWarning: Glyph 128200 (\N{CHART WITH UPWARDS TREND}) missing from font(s) DejaVu Sans.
  fig.canvas.print_figure(bytes_io, **kw)
</pre></div>
</div>
<img alt="_images/ed85f945dfb043b9b12fb451f748dd71b8d42a9c05fe0317f299155538e056ca.png" src="_images/ed85f945dfb043b9b12fb451f748dd71b8d42a9c05fe0317f299155538e056ca.png" />
</div>
</div>
<section id="analisis-de-resultados-del-modelo-knn-15m">
<h2>An√°lisis de Resultados del Modelo KNN (15m)<a class="headerlink" href="#analisis-de-resultados-del-modelo-knn-15m" title="Link to this heading">#</a></h2>
<section id="precio-real-vs-predicho">
<h3>Precio Real vs. Predicho<a class="headerlink" href="#precio-real-vs-predicho" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>La l√≠nea negra representa el precio real del activo.</p></li>
<li><p>La l√≠nea roja discontinua representa los valores predichos por el modelo KNN.</p></li>
<li><p>Se observa que el modelo sigue la tendencia general, pero con una subestimaci√≥n significativa en algunos per√≠odos.</p></li>
</ul>
</section>
<section id="autocorrelacion-de-los-residuos-acf">
<h3>Autocorrelaci√≥n de los Residuos (ACF)<a class="headerlink" href="#autocorrelacion-de-los-residuos-acf" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>La gr√°fica ACF muestra una alta autocorrelaci√≥n en los residuos.</p></li>
<li><p>Esto indica que los errores del modelo no son independientes, lo que sugiere que el modelo KNN no est√° capturando completamente la estructura temporal de los datos.</p></li>
<li><p>Un buen modelo deber√≠a mostrar residuos con baja autocorrelaci√≥n, lo que no sucede aqu√≠.</p></li>
</ul>
</section>
<section id="histograma-de-los-residuos">
<h3>Histograma de los Residuos<a class="headerlink" href="#histograma-de-los-residuos" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Se observa una distribuci√≥n sesgada a la derecha, con una acumulaci√≥n significativa de residuos cerca de 0.</p></li>
<li><p>Esto sugiere que el modelo tiene errores peque√±os la mayor parte del tiempo, pero tambi√©n presenta algunos errores grandes ocasionalmente.</p></li>
<li><p>La presencia de varios picos en la distribuci√≥n puede indicar que los datos tienen diferentes comportamientos en ciertos per√≠odos.</p></li>
</ul>
</section>
</section>
<section id="algoritmo-de-optimizacion">
<h2>Algoritmo de Optimizacion<a class="headerlink" href="#algoritmo-de-optimizacion" title="Link to this heading">#</a></h2>
<section id="knn-kd-trees-ball-trees-faiss">
<h3>KNN ‚Üí KD-Trees, Ball Trees, FAISS.<a class="headerlink" href="#knn-kd-trees-ball-trees-faiss" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">faiss</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>

<span class="c1"># Modelos KNN con diferentes algoritmos</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;KNN (KD-Tree)&quot;</span><span class="p">:</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;kd_tree&#39;</span><span class="p">),</span>
    <span class="s2">&quot;KNN (Ball Tree)&quot;</span><span class="p">:</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ball_tree&#39;</span><span class="p">),</span>
<span class="p">}</span>

<span class="c1"># Crear un √≠ndice FAISS (KNN basado en vectores)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">X_train_15m</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Dimensi√≥n de las caracter√≠sticas</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">faiss</span><span class="o">.</span><span class="n">IndexFlatL2</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">faiss_index</span> <span class="o">=</span> <span class="n">faiss</span><span class="o">.</span><span class="n">IndexIDMap</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Convertir datos a float32 (FAISS lo requiere)</span>
<span class="n">X_train_faiss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">X_train_15m</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">))</span>
<span class="n">faiss_index</span><span class="o">.</span><span class="n">add_with_ids</span><span class="p">(</span><span class="n">X_train_faiss</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">X_train_faiss</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="c1"># Medir tiempos</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">)</span>
    <span class="n">train_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_15m</span><span class="p">)</span>
    <span class="n">pred_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">train_time</span><span class="p">,</span> <span class="n">pred_time</span><span class="p">))</span>

<span class="c1"># Medir tiempo de predicci√≥n con FAISS</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Vecinos</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">D</span><span class="p">,</span> <span class="n">I</span> <span class="o">=</span> <span class="n">faiss_index</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">X_test_15m</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)),</span> <span class="n">k</span><span class="p">)</span>
<span class="n">pred_time_faiss</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s2">&quot;KNN (FAISS)&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A (√çndice preconstruido)&quot;</span><span class="p">,</span> <span class="n">pred_time_faiss</span><span class="p">))</span>

<span class="c1"># Mostrar resultados</span>
<span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">train_time</span><span class="p">,</span> <span class="n">pred_time</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">: Entrenamiento = </span><span class="si">{</span><span class="n">train_time</span><span class="si">}</span><span class="s2"> s, Predicci√≥n = </span><span class="si">{</span><span class="n">pred_time</span><span class="si">}</span><span class="s2"> s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KNN (KD-Tree): Entrenamiento = 0.0038404464721679688 s, Predicci√≥n = 0.007334709167480469 s
KNN (Ball Tree): Entrenamiento = 0.005292177200317383 s, Predicci√≥n = 0.016489267349243164 s
KNN (FAISS): Entrenamiento = N/A (√çndice preconstruido) s, Predicci√≥n = 0.4243783950805664 s
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="clasificador-naive-bayes">
<h1>Clasificador Naive Bayes<a class="headerlink" href="#clasificador-naive-bayes" title="Link to this heading">#</a></h1>
<section id="definicion-basado-en-el-teorema-de-bayes-asume-independencia-entre-caracteristicas-naive-para-calcular-probabilidades-de-pertenencia-a-cada-clase">
<h2>Definici√≥n: Basado en el teorema de Bayes, asume independencia entre caracter√≠sticas (naive) para calcular probabilidades de pertenencia a cada clase.<a class="headerlink" href="#definicion-basado-en-el-teorema-de-bayes-asume-independencia-entre-caracteristicas-naive-para-calcular-probabilidades-de-pertenencia-a-cada-clase" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">BayesianRidge</span>

<span class="c1"># Bayesian Ridge para datos de 15m</span>
<span class="n">bayes_ridge_15m</span> <span class="o">=</span> <span class="n">BayesianRidge</span><span class="p">()</span>
<span class="n">bayes_ridge_15m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-4 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-4 {
  color: var(--sklearn-color-text);
}

#sk-container-id-4 pre {
  padding: 0;
}

#sk-container-id-4 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-4 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-4 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-4 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-4 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-4 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-4 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-4 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-4 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-4 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-4 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-4 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-4 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-4 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-4 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "‚ñ∏";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-4 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-4 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-4 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-4 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "‚ñæ";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-4 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-4 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-4 div.sk-label label.sk-toggleable__label,
#sk-container-id-4 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-4 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-4 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-4 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-4 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-4 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-4 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-4 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-4 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-4 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-4 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-4 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-4" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>BayesianRidge()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox" checked><label for="sk-estimator-id-4" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>BayesianRidge</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.linear_model.BayesianRidge.html">?<span>Documentation for BayesianRidge</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted"><pre>BayesianRidge()</pre></div> </div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">BayesianRidge</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="c1"># Cargar datos de entrenamiento y prueba (simulados en este caso)</span>
<span class="c1"># Aseg√∫rate de reemplazar esto con tus datos reales</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_train_15m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">y_train_15m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10000</span>
<span class="n">X_test_15m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">y_test_15m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10000</span>

<span class="c1"># Inicializar y entrenar el modelo Bayesian Ridge</span>
<span class="n">bayes_ridge_15m</span> <span class="o">=</span> <span class="n">BayesianRidge</span><span class="p">()</span>
<span class="n">bayes_ridge_15m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">)</span>

<span class="c1"># Predicciones</span>
<span class="n">y_pred_15m</span> <span class="o">=</span> <span class="n">bayes_ridge_15m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_15m</span><span class="p">)</span>

<span class="c1"># Calcular residuos</span>
<span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test_15m</span> <span class="o">-</span> <span class="n">y_pred_15m</span>

<span class="c1"># M√âTRICAS DE EVALUACI√ìN</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_15m</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_15m</span><span class="p">))</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_15m</span><span class="p">)</span>

<span class="c1"># Prueba de Ljung-Box (autocorrelaci√≥n de residuos)</span>
<span class="n">ljung_box_result</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ljung_box_pvalue</span> <span class="o">=</span> <span class="n">ljung_box_result</span><span class="p">[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Prueba de Jarque-Bera (normalidad de residuos)</span>
<span class="n">jb_result</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
<span class="n">jb_stat</span><span class="p">,</span> <span class="n">jb_pvalue</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">jb_result</span>

<span class="c1"># Crear tabla de resultados</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mape</span><span class="p">],</span>
    <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">rmse</span><span class="p">],</span>
    <span class="s1">&#39;R¬≤&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">r2</span><span class="p">],</span>
    <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">ljung_box_pvalue</span><span class="p">],</span>
    <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">jb_pvalue</span><span class="p">]</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> RESULTADOS DEL MODELO BAYESIAN RIDGE (15m):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>

<span class="c1"># GRAFICAR RESULTADOS</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1">#  Precio real vs Predicho</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Real&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred_15m</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Predicho&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot; Precio Real vs. Predicho&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Autocorrelaci√≥n de residuos (ACF)</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot; ACF de los residuos&quot;</span><span class="p">)</span>

<span class="c1"># Histograma de los residuos</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot; Histograma de los residuos&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Devolver las m√©tricas para an√°lisis adicional</span>
<span class="n">results_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> RESULTADOS DEL MODELO BAYESIAN RIDGE (15m):
       MAPE         RMSE        R¬≤  Ljung-Box p-value  Jarque-Bera p-value
0  7.902562  2871.155908 -0.001745           0.072954             0.000224
</pre></div>
</div>
<img alt="_images/26f859a09fd69eb392ed0dde14c8c540e288b260b7a98d574e7ba7d4db6cf5b4.png" src="_images/26f859a09fd69eb392ed0dde14c8c540e288b260b7a98d574e7ba7d4db6cf5b4.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R¬≤</th>
      <th>Ljung-Box p-value</th>
      <th>Jarque-Bera p-value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7.902562</td>
      <td>2871.155908</td>
      <td>-0.001745</td>
      <td>0.072954</td>
      <td>0.000224</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="analisis-del-modelo-bayesian-ridge-15m">
<h1>An√°lisis del Modelo Bayesian Ridge (15m)<a class="headerlink" href="#analisis-del-modelo-bayesian-ridge-15m" title="Link to this heading">#</a></h1>
<section id="metricas-de-evaluacion">
<h2>M√©tricas de Evaluaci√≥n<a class="headerlink" href="#metricas-de-evaluacion" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>M√©trica</p></th>
<th class="head"><p>Valor</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>MAPE</strong></p></td>
<td><p>7.90%</p></td>
</tr>
<tr class="row-odd"><td><p><strong>RMSE</strong></p></td>
<td><p>2871.16</p></td>
</tr>
<tr class="row-even"><td><p><strong>R¬≤</strong></p></td>
<td><p>-0.0017</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Ljung-Box p-value</strong></p></td>
<td><p>0.0729</p></td>
</tr>
<tr class="row-even"><td><p><strong>Jarque-Bera p-value</strong></p></td>
<td><p>0.0002</p></td>
</tr>
</tbody>
</table>
</div>
<section id="interpretacion">
<h3>Interpretaci√≥n:<a class="headerlink" href="#interpretacion" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>MAPE (Mean Absolute Percentage Error):</strong> Un 7.90% indica que el modelo tiene un error relativo moderado en la predicci√≥n.</p></li>
<li><p><strong>RMSE (Root Mean Squared Error):</strong> Un valor de 2871.16 indica un error absoluto relativamente alto.</p></li>
<li><p><strong>R¬≤ (Coeficiente de Determinaci√≥n):</strong> Un valor negativo (-0.0017) sugiere que el modelo no logra explicar la variabilidad de los datos mejor que un modelo trivial (promedio).</p></li>
<li><p><strong>Ljung-Box p-value:</strong> 0.0729 indica que los residuos no presentan una autocorrelaci√≥n significativa.</p></li>
<li><p><strong>Jarque-Bera p-value:</strong> 0.0002 sugiere que los residuos no siguen una distribuci√≥n normal, lo cual podr√≠a afectar el rendimiento del modelo.</p></li>
</ul>
</section>
</section>
<section id="graficos-de-evaluacion">
<h2>Gr√°ficos de Evaluaci√≥n<a class="headerlink" href="#graficos-de-evaluacion" title="Link to this heading">#</a></h2>
<p><strong>Precio Real vs. Predicho</strong></p>
<ul class="simple">
<li><p>El modelo predice valores cercanos a una media constante sin captar la tendencia ni la variabilidad de los datos.</p></li>
<li><p>Indica que el modelo no est√° ajustando correctamente los patrones temporales.</p></li>
</ul>
<p><strong>Autocorrelaci√≥n de Residuos (ACF)</strong></p>
<ul class="simple">
<li><p>No hay evidencia fuerte de autocorrelaci√≥n en los residuos, lo que indica independencia en los errores.</p></li>
<li><p>Esto sugiere que el modelo no tiene memoria sobre valores pasados.</p></li>
</ul>
<p><strong>Histograma de Residuos</strong></p>
<ul class="simple">
<li><p>Los residuos no siguen una distribuci√≥n normal, lo que puede impactar negativamente la precisi√≥n del modelo.</p></li>
<li><p>Se observa una dispersi√≥n significativa con valores extremos.</p></li>
</ul>
</section>
<section id="conclusion-y-siguientes-pasos">
<h2>Conclusi√≥n y Siguientes Pasos<a class="headerlink" href="#conclusion-y-siguientes-pasos" title="Link to this heading">#</a></h2>
<p>El modelo <strong>Bayesian Ridge no es una buena opci√≥n</strong> para estos datos.</p>
</section>
<section id="id1">
<h2>Algoritmo de Optimizacion<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<section id="naive-bayes-partial-fit-para-entrenamiento-por-lotes">
<h3>Naive Bayes ‚Üí partial_fit() para entrenamiento por lotes.<a class="headerlink" href="#naive-bayes-partial-fit-para-entrenamiento-por-lotes" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">BayesianRidge</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Bayesian Ridge para datos 15min (Ajuste completo)</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">bayes_ridge_15m</span> <span class="o">=</span> <span class="n">BayesianRidge</span><span class="p">()</span>
<span class="n">bayes_ridge_15m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">)</span>
<span class="n">std_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>  <span class="c1"># Tiempo del ajuste completo</span>

<span class="c1"># Bayesian Ridge con entrenamiento en lotes</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">bayes_ridge_online</span> <span class="o">=</span> <span class="n">BayesianRidge</span><span class="p">()</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">):</span>
    <span class="n">X_batch</span> <span class="o">=</span> <span class="n">X_train_15m</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">batch_size</span><span class="p">]</span>
    <span class="n">y_batch</span> <span class="o">=</span> <span class="n">y_train_15m</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">batch_size</span><span class="p">]</span>
    <span class="n">bayes_ridge_online</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_batch</span><span class="p">,</span> <span class="n">y_batch</span><span class="p">)</span>  <span class="c1"># Ajuste en lotes</span>
<span class="n">online_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>  <span class="c1"># Tiempo del ajuste por lotes</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tiempos Bayesian Ridge:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Fit completo: </span><span class="si">{</span><span class="n">std_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Fit en lotes (batch=</span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">online_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tiempos Bayesian Ridge:
- Fit completo: 0.0120s
- Fit en lotes (batch=100): 0.0132s
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="regresion-logistica-con-regularizacion-l1-l2">
<h1>Regresi√≥n Log√≠stica (con regularizaci√≥n L1/L2)<a class="headerlink" href="#regresion-logistica-con-regularizacion-l1-l2" title="Link to this heading">#</a></h1>
<section id="definicion-modelo-lineal-para-clasificacion-binaria-que-transforma-una-combinacion-lineal-de-inputs-mediante-la-funcion-sigmoide-para-estimar-probabilidades">
<h2>Definici√≥n: Modelo lineal para clasificaci√≥n binaria que transforma una combinaci√≥n lineal de inputs mediante la funci√≥n sigmoide para estimar probabilidades.<a class="headerlink" href="#definicion-modelo-lineal-para-clasificacion-binaria-que-transforma-una-combinacion-lineal-de-inputs-mediante-la-funcion-sigmoide-para-estimar-probabilidades" title="Link to this heading">#</a></h2>
</section>
<section id="ridge-regression">
<h2>Ridge Regression<a class="headerlink" href="#ridge-regression" title="Link to this heading">#</a></h2>
<section id="definicion-tecnica-de-regularizacion-l2-para-modelos-lineales-que-penaliza-los-coeficientes-grandes-para-reducir-sobreajuste">
<h3>Definici√≥n: T√©cnica de regularizaci√≥n L2 para modelos lineales que penaliza los coeficientes grandes para reducir sobreajuste.<a class="headerlink" href="#definicion-tecnica-de-regularizacion-l2-para-modelos-lineales-que-penaliza-los-coeficientes-grandes-para-reducir-sobreajuste" title="Link to this heading">#</a></h3>
</section>
</section>
<section id="lasso-regression">
<h2>Lasso Regression<a class="headerlink" href="#lasso-regression" title="Link to this heading">#</a></h2>
<section id="definicion-tecnica-de-regularizacion-l1-que-no-solo-previene-sobreajuste-sino-que-tambien-realiza-seleccion-de-caracteristicas-al-forzar-coeficientes-a-cero">
<h3>Definici√≥n: T√©cnica de regularizaci√≥n L1 que no solo previene sobreajuste sino que tambi√©n realiza selecci√≥n de caracter√≠sticas al forzar coeficientes a cero.<a class="headerlink" href="#definicion-tecnica-de-regularizacion-l1-que-no-solo-previene-sobreajuste-sino-que-tambien-realiza-seleccion-de-caracteristicas-al-forzar-coeficientes-a-cero" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">LassoCV</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Ridge optimizado con solver &#39;saga&#39;</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">saga_ridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;saga&#39;</span><span class="p">)</span>
<span class="n">saga_ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">)</span>
<span class="n">saga_ridge_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="c1"># Lasso optimizado con selecci√≥n autom√°tica de alpha (en vez de solver &#39;saga&#39;)</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">lasso_cv</span> <span class="o">=</span> <span class="n">LassoCV</span><span class="p">(</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>  <span class="c1"># Optimiza autom√°ticamente alpha</span>
<span class="n">lasso_cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">)</span>
<span class="n">lasso_cv_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tiempos con optimizaci√≥n:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Ridge (SAGA): </span><span class="si">{</span><span class="n">saga_ridge_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Lasso (CV, selecci√≥n de alpha): </span><span class="si">{</span><span class="n">lasso_cv_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Mejor alpha para Lasso: </span><span class="si">{</span><span class="n">lasso_cv</span><span class="o">.</span><span class="n">alpha_</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/elianafuentes/miniconda3/envs/ml_venv/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:348: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tiempos con optimizaci√≥n:
- Ridge (SAGA): 27.1202s
- Lasso (CV, selecci√≥n de alpha): 0.3940s
- Mejor alpha para Lasso: 258886.7065
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="analisis-de-optimizacion-ridge-vs-lasso">
<h1>An√°lisis de Optimizaci√≥n: Ridge vs. Lasso<a class="headerlink" href="#analisis-de-optimizacion-ridge-vs-lasso" title="Link to this heading">#</a></h1>
<section id="comparacion-de-tiempos-de-entrenamiento">
<h2>Comparaci√≥n de Tiempos de Entrenamiento<a class="headerlink" href="#comparacion-de-tiempos-de-entrenamiento" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Modelo</p></th>
<th class="head"><p>Tiempo (segundos)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Ridge (SAGA)</strong></p></td>
<td><p>0.0122s</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Lasso (CV, selecci√≥n de Œ±)</strong></p></td>
<td><p>0.0246s</p></td>
</tr>
</tbody>
</table>
</div>
<section id="id2">
<h3>Interpretaci√≥n:<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Ridge (SAGA)</strong> se entren√≥ en <strong>0.0122s</strong>, mostrando una ejecuci√≥n m√°s r√°pida debido a su uso del solver <code class="docutils literal notranslate"><span class="pre">'saga'</span></code>, que es eficiente para problemas de regresi√≥n grande y dispersa.</p></li>
<li><p><strong>Lasso (CV, selecci√≥n autom√°tica de Œ±)</strong> tard√≥ <strong>0.0246s</strong>, m√°s del doble que Ridge, debido a la validaci√≥n cruzada para encontrar el mejor <strong>Œ±</strong>.</p></li>
<li><p>El <strong>mejor Œ± para Lasso</strong> encontrado autom√°ticamente fue <strong>43.5330</strong>, lo que indica la penalizaci√≥n √≥ptima aplicada a los coeficientes.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -------------------------------------------</span>
<span class="c1"># 2. M√âTRICAS DE EVALUACI√ìN</span>
<span class="c1"># -------------------------------------------</span>

<span class="c1"># M√©tricas para Ridge</span>
<span class="n">mape_ridge</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_ridge</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">rmse_ridge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_ridge</span><span class="p">))</span>
<span class="n">r2_ridge</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_ridge</span><span class="p">)</span>

<span class="c1"># M√©tricas para Lasso</span>
<span class="n">mape_lasso</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_lasso</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">rmse_lasso</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_lasso</span><span class="p">))</span>
<span class="n">r2_lasso</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_lasso</span><span class="p">)</span>

<span class="c1"># -------------------------------------------</span>
<span class="c1"># 3. PRUEBAS ESTAD√çSTICAS</span>
<span class="c1"># -------------------------------------------</span>

<span class="c1"># Ljung-Box (20 lags)</span>
<span class="n">ljung_box_ridge</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals_ridge</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ljung_box_pvalue_ridge</span> <span class="o">=</span> <span class="n">ljung_box_ridge</span><span class="p">[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">ljung_box_lasso</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals_lasso</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ljung_box_pvalue_lasso</span> <span class="o">=</span> <span class="n">ljung_box_lasso</span><span class="p">[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Jarque-Bera</span>
<span class="n">jb_ridge</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">stattools</span><span class="o">.</span><span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals_ridge</span><span class="p">)</span>
<span class="n">jb_pvalue_ridge</span> <span class="o">=</span> <span class="n">jb_ridge</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">jb_lasso</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">stattools</span><span class="o">.</span><span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals_lasso</span><span class="p">)</span>
<span class="n">jb_pvalue_lasso</span> <span class="o">=</span> <span class="n">jb_lasso</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># -------------------------------------------</span>
<span class="c1"># 4. TABLA COMPARATIVA</span>
<span class="c1"># -------------------------------------------</span>
<span class="n">results_linear</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Ridge (SAGA)&#39;</span><span class="p">,</span> <span class="s1">&#39;Lasso (CV)&#39;</span><span class="p">],</span>
    <span class="s1">&#39;MAPE (%)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mape_ridge</span><span class="p">,</span> <span class="n">mape_lasso</span><span class="p">],</span>
    <span class="s1">&#39;RMSE (USD)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">rmse_ridge</span><span class="p">,</span> <span class="n">rmse_lasso</span><span class="p">],</span>
    <span class="s1">&#39;R¬≤&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">r2_ridge</span><span class="p">,</span> <span class="n">r2_lasso</span><span class="p">],</span>
    <span class="s1">&#39;Ljung-Box (p-val)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">ljung_box_pvalue_ridge</span><span class="p">,</span> <span class="n">ljung_box_pvalue_lasso</span><span class="p">],</span>
    <span class="s1">&#39;Normalidad (p-val)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">jb_pvalue_ridge</span><span class="p">,</span> <span class="n">jb_pvalue_lasso</span><span class="p">]</span>
<span class="p">})</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">RESULTADOS COMPARATIVOS (MODELOS LINEALES):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_linear</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># -------------------------------------------</span>
<span class="c1"># 5. GR√ÅFICAS COMPARATIVAS</span>
<span class="c1"># -------------------------------------------</span>

<span class="c1"># Configuraci√≥n com√∫n para gr√°ficas</span>
<span class="n">plot_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;real_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
    <span class="s1">&#39;real_label&#39;</span><span class="p">:</span> <span class="s1">&#39;Real&#39;</span><span class="p">,</span>
    <span class="s1">&#39;resid_color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
    <span class="s1">&#39;figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Gr√°ficas para Ridge</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Serie Temporal</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plot_params</span><span class="p">[</span><span class="s1">&#39;real_color&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">plot_params</span><span class="p">[</span><span class="s1">&#39;real_label&#39;</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred_ridge</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ridge&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Predicciones: Ridge (SAGA)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Autocorrelaci√≥n Residuos</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">residuals_ridge</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Autocorrelaci√≥n Residuos (Ridge)&quot;</span><span class="p">)</span>

<span class="c1"># Distribuci√≥n Residuos</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">residuals_ridge</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;navy&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plot_params</span><span class="p">[</span><span class="s1">&#39;resid_color&#39;</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribuci√≥n Residuos (Ridge)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Gr√°ficas para Lasso</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Serie Temporal</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plot_params</span><span class="p">[</span><span class="s1">&#39;real_color&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">plot_params</span><span class="p">[</span><span class="s1">&#39;real_label&#39;</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred_lasso</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lasso&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Predicciones: Lasso (CV)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Autocorrelaci√≥n Residuos</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">residuals_lasso</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Autocorrelaci√≥n Residuos (Lasso)&quot;</span><span class="p">)</span>

<span class="c1"># Distribuci√≥n Residuos</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">residuals_lasso</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgreen&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plot_params</span><span class="p">[</span><span class="s1">&#39;resid_color&#39;</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribuci√≥n Residuos (Lasso)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RESULTADOS COMPARATIVOS (MODELOS LINEALES):
      Modelo  MAPE (%)  RMSE (USD)     R¬≤  Ljung-Box (p-val)  Normalidad (p-val)
Ridge (SAGA)    0.2080    220.7950 0.9999                0.0                 0.0
  Lasso (CV)    0.3353    354.5547 0.9997                0.0                 0.0
</pre></div>
</div>
<img alt="_images/4b2912867058df732a3fdcdd2ce237db1a4ae8e60e4713b146a06557d8033a63.png" src="_images/4b2912867058df732a3fdcdd2ce237db1a4ae8e60e4713b146a06557d8033a63.png" />
<img alt="_images/3a1109de36e983101cfb12eaa79e117a7d5c64a0b450f848382773e672b9a207.png" src="_images/3a1109de36e983101cfb12eaa79e117a7d5c64a0b450f848382773e672b9a207.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="analisis-de-resultados-modelos-ridge-saga-vs-lasso-cv">
<h1>An√°lisis de Resultados: Modelos Ridge (SAGA) vs Lasso (CV)<a class="headerlink" href="#analisis-de-resultados-modelos-ridge-saga-vs-lasso-cv" title="Link to this heading">#</a></h1>
<section id="metricas-de-rendimiento">
<h2>M√©tricas de Rendimiento<a class="headerlink" href="#metricas-de-rendimiento" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Modelo</p></th>
<th class="head"><p>MAPE (%)</p></th>
<th class="head"><p>RMSE (USD)</p></th>
<th class="head"><p>R¬≤</p></th>
<th class="head"><p>Ljung-Box (p-val)</p></th>
<th class="head"><p>Normalidad (p-val)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Ridge (SAGA)</p></td>
<td><p>0.2080</p></td>
<td><p>220.7950</p></td>
<td><p>0.9999</p></td>
<td><p>0.0</p></td>
<td><p>0.0</p></td>
</tr>
<tr class="row-odd"><td><p>Lasso (CV)</p></td>
<td><p>0.3353</p></td>
<td><p>354.5547</p></td>
<td><p>0.9997</p></td>
<td><p>0.0</p></td>
<td><p>0.0</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="interpretacion-de-resultados">
<h2>Interpretaci√≥n de Resultados<a class="headerlink" href="#interpretacion-de-resultados" title="Link to this heading">#</a></h2>
<section id="precision-predictiva">
<h3>Precisi√≥n Predictiva<a class="headerlink" href="#precision-predictiva" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Ridge (SAGA)</strong> muestra un mejor desempe√±o general con:</p>
<ul>
<li><p>MAPE m√°s bajo (0.2080% vs 0.3353%)</p></li>
<li><p>RMSE significativamente menor (220.8 USD vs 354.6 USD)</p></li>
<li><p>R¬≤ ligeramente superior (0.9999 vs 0.9997)</p></li>
</ul>
</li>
</ul>
</section>
<section id="analisis-de-residuos">
<h3>An√°lisis de Residuos<a class="headerlink" href="#analisis-de-residuos" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Autocorrelaci√≥n de Residuos</strong>:</p>
<ul class="simple">
<li><p><strong>Ridge</strong>: Muestra una autocorrelaci√≥n significativa solo en el primer rezago</p></li>
<li><p><strong>Lasso</strong>: Exhibe autocorrelaci√≥n significativa en m√∫ltiples rezagos (aproximadamente hasta el 7¬∫)</p></li>
<li><p>Ambos modelos tienen p-valor de 0.0 en la prueba Ljung-Box, indicando presencia de autocorrelaci√≥n</p></li>
</ul>
</li>
<li><p><strong>Distribuci√≥n de Residuos</strong>:</p>
<ul class="simple">
<li><p>Ambos modelos muestran distribuciones centradas en cero</p></li>
<li><p><strong>Ridge</strong>: Distribuci√≥n m√°s concentrada alrededor de cero (menor dispersi√≥n)</p></li>
<li><p><strong>Lasso</strong>: Distribuci√≥n ligeramente m√°s amplia</p></li>
<li><p>El p-valor de 0.0 en la prueba de normalidad sugiere que los residuos no siguen una distribuci√≥n normal</p></li>
</ul>
</li>
</ol>
</section>
<section id="ajuste-a-los-datos">
<h3>Ajuste a los Datos<a class="headerlink" href="#ajuste-a-los-datos" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Ambos modelos capturan excelentemente la tendencia general de los datos</p></li>
<li><p><strong>Ridge</strong> parece tener un ajuste m√°s preciso, especialmente en las fluctuaciones</p></li>
<li><p><strong>Lasso</strong> muestra ligeras desviaciones en algunos picos y valles</p></li>
</ul>
</section>
</section>
<section id="conclusiones">
<h2>Conclusiones<a class="headerlink" href="#conclusiones" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Modelo Recomendado</strong>: El modelo <strong>Ridge (SAGA)</strong> supera al Lasso en todas las m√©tricas evaluadas:</p>
<ul class="simple">
<li><p>Error porcentual y absoluto menor</p></li>
<li><p>Mejor coeficiente de determinaci√≥n</p></li>
<li><p>Residuos con menor autocorrelaci√≥n</p></li>
</ul>
</li>
<li><p><strong>Consideraciones Estad√≠sticas</strong>:</p>
<ul class="simple">
<li><p>Ambos modelos presentan residuos no normales y con autocorrelaci√≥n</p></li>
<li><p>Esto podr√≠a indicar que hay estructura temporal en los datos no completamente capturada</p></li>
</ul>
</li>
<li><p><strong>Implicaciones Pr√°cticas</strong>:</p>
<ul class="simple">
<li><p>El error porcentual medio de Ridge (0.21%) es excepcionalmente bajo para predicciones financieras</p></li>
<li><p>La diferencia de RMSE (133.76 USD) entre modelos puede ser significativa dependiendo del contexto financiero</p></li>
<li><p>El modelo Ridge parece m√°s robusto para capturar las fluctuaciones de la serie temporal</p></li>
</ul>
</li>
</ol>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id3">
<h1>ALgoritmo de Optimizacion<a class="headerlink" href="#id3" title="Link to this heading">#</a></h1>
<section id="ridge-lasso-solver-optimizado-saga">
<h2>Ridge/Lasso ‚Üí Solver optimizado saga.<a class="headerlink" href="#ridge-lasso-solver-optimizado-saga" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Ridge optimizado con solver &#39;saga&#39;</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">saga_ridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;saga&#39;</span><span class="p">)</span>
<span class="n">saga_ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">)</span>
<span class="n">saga_ridge_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="c1"># Lasso optimizado con solver &#39;saga&#39;</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">saga_lasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>  <span class="c1"># saga para Lasso puede requerir m√°s iteraciones</span>
<span class="n">saga_lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">)</span>
<span class="n">saga_lasso_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tiempos con optimizaci√≥n SAGA:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Ridge (SAGA): </span><span class="si">{</span><span class="n">saga_ridge_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Lasso (SAGA): </span><span class="si">{</span><span class="n">saga_lasso_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tiempos con optimizaci√≥n SAGA:
- Ridge (SAGA): 0.0107s
- Lasso (SAGA): 0.0013s
</pre></div>
</div>
</div>
</div>
</section>
<section id="analisis-de-la-optimizacion-con-saga">
<h2>An√°lisis de la Optimizaci√≥n con SAGA<a class="headerlink" href="#analisis-de-la-optimizacion-con-saga" title="Link to this heading">#</a></h2>
<p>Tras aplicar la optimizaci√≥n con el solver <code class="docutils literal notranslate"><span class="pre">'saga'</span></code> para Ridge y Lasso, obtuvimos los siguientes tiempos de ejecuci√≥n:</p>
<section id="observaciones">
<h3>Observaciones<a class="headerlink" href="#observaciones" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Diferencia de tiempos</strong></p>
<ul class="simple">
<li><p>El tiempo de ejecuci√≥n de Ridge es <strong>excesivamente alto</strong> en comparaci√≥n con Lasso.</p></li>
<li><p>Esto sugiere que Ridge con SAGA no es la opci√≥n m√°s eficiente en este caso.</p></li>
</ul>
</li>
</ol>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="decision-tree">
<h1>Decision Tree<a class="headerlink" href="#decision-tree" title="Link to this heading">#</a></h1>
<section id="definicion-modelo-de-aprendizaje-supervisado-que-divide-recursivamente-el-espacio-de-caracteristicas-mediante-reglas-de-decision-binarias">
<h2>Definici√≥n: Modelo de aprendizaje supervisado que divide recursivamente el espacio de caracter√≠sticas mediante reglas de decisi√≥n binarias.<a class="headerlink" href="#definicion-modelo-de-aprendizaje-supervisado-que-divide-recursivamente-el-espacio-de-caracteristicas-mediante-reglas-de-decision-binarias" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>


<span class="c1"># √Årbol de decisi√≥n para datos de 15m (Regresi√≥n)</span>
<span class="n">tree_15m</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">tree_15m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-1 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "‚ñ∏";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "‚ñæ";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>DecisionTreeRegressor(max_depth=5)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>DecisionTreeRegressor</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.tree.DecisionTreeRegressor.html">?<span>Documentation for DecisionTreeRegressor</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted"><pre>DecisionTreeRegressor(max_depth=5)</pre></div> </div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>

<span class="c1"># -------------------------------------------</span>
<span class="c1"># 1. PREDICCIONES Y RESIDUOS (CON VALIDACI√ìN)</span>
<span class="c1"># -------------------------------------------</span>

<span class="c1"># Asegurar alineaci√≥n de √≠ndices (critical en series temporales)</span>
<span class="n">y_pred_tree</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
    <span class="n">tree_15m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_15m</span><span class="p">),</span> 
    <span class="n">index</span><span class="o">=</span><span class="n">y_test_15m</span><span class="o">.</span><span class="n">index</span>  <span class="c1"># &lt;--- Corrige desfases gr√°ficos</span>
<span class="p">)</span>

<span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test_15m</span> <span class="o">-</span> <span class="n">y_pred_tree</span>  <span class="c1"># &lt;--- Residuos alineados</span>

<span class="c1"># -------------------------------------------</span>
<span class="c1"># 2. M√âTRICAS DE EVALUACI√ìN (CON VALIDACI√ìN)</span>
<span class="c1"># -------------------------------------------</span>

<span class="c1"># Calcular m√©tricas b√°sicas</span>
<span class="n">mape_tree</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_tree</span><span class="p">)</span>
<span class="n">rmse_tree</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_tree</span><span class="p">))</span>
<span class="n">r2_tree</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_tree</span><span class="p">)</span>

<span class="c1"># Pruebas estad√≠sticas (usar m√°s lags para Ljung-Box)</span>
<span class="n">ljung_box_result</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># &lt;--- 20 lags</span>
<span class="n">ljung_box_pvalue</span> <span class="o">=</span> <span class="n">ljung_box_result</span><span class="p">[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Jarque-Bera con statsmodels (versi√≥n actualizada)</span>
<span class="n">jb_test</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">stattools</span><span class="o">.</span><span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
<span class="n">jb_pvalue</span> <span class="o">=</span> <span class="n">jb_test</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># -------------------------------------------</span>
<span class="c1"># 3. TABLA DE RESULTADOS (MEJOR FORMATO)</span>
<span class="c1"># -------------------------------------------</span>
<span class="n">results_tree</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;√Årbol de Decisi√≥n&#39;</span><span class="p">],</span>
    <span class="s1">&#39;MAPE (%)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mape_tree</span> <span class="o">*</span> <span class="mi">100</span><span class="p">],</span>  <span class="c1"># &lt;-- M√°s interpretable</span>
    <span class="s1">&#39;RMSE (USD)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">rmse_tree</span><span class="p">],</span>
    <span class="s1">&#39;R¬≤&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">r2_tree</span><span class="p">],</span>
    <span class="s1">&#39;Ljung-Box (p-val)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">ljung_box_pvalue</span><span class="p">],</span>
    <span class="s1">&#39;Normalidad (p-val)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">jb_pvalue</span><span class="p">]</span>
<span class="p">})</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># &lt;--- Redondeo para claridad</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">RESULTADOS DEL MODELO (√ÅRBOL DE DECISI√ìN):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_tree</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># -------------------------------------------</span>
<span class="c1"># 4. GR√ÅFICAS (ETIQUETAS CLARAS Y ESCALAS)</span>
<span class="c1"># -------------------------------------------</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># A. Precio Real vs. Predicho (con ejes expl√≠citos)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Real&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred_tree</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Predicho&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Precio Real vs. Predicho (√Årbol de Decisi√≥n)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;√çndice Temporal&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Precio (USD)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># B. Autocorrelaci√≥n de residuos (mismos lags que Ljung-Box)</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Autocorrelaci√≥n de Residuos&quot;</span><span class="p">)</span>

<span class="c1"># C. Histograma de residuos (con etiquetas claras)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;purple&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribuci√≥n de Residuos&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Error de Predicci√≥n (USD)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RESULTADOS DEL MODELO (√ÅRBOL DE DECISI√ìN):
           Modelo  MAPE (%)  RMSE (USD)     R¬≤  Ljung-Box (p-val)  Normalidad (p-val)
√Årbol de Decisi√≥n    7.7949  13960.9247 0.5619                0.0                 0.0
</pre></div>
</div>
<img alt="_images/9240b1093c6739ba4c60c4c473976db6428a6939c3028d0faf11dec9d79e6f12.png" src="_images/9240b1093c6739ba4c60c4c473976db6428a6939c3028d0faf11dec9d79e6f12.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="analisis-del-modelo-decision-tree-15m">
<h1>An√°lisis del Modelo Decision Tree (15m)<a class="headerlink" href="#analisis-del-modelo-decision-tree-15m" title="Link to this heading">#</a></h1>
<section id="configuracion-del-modelo">
<h2>Configuraci√≥n del modelo<a class="headerlink" href="#configuracion-del-modelo" title="Link to this heading">#</a></h2>
<p>Se entren√≥ un <strong>√Årbol de Decisi√≥n</strong> con los siguientes par√°metros:<br />
<strong>max_depth = 5</strong> ‚Üí Controla la profundidad del √°rbol para evitar sobreajuste.</p>
</section>
<hr class="docutils" />
<section id="id4">
<h2>M√©tricas de Evaluaci√≥n<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Modelo</p></th>
<th class="head"><p>MAPE</p></th>
<th class="head"><p>RMSE</p></th>
<th class="head"><p>R¬≤</p></th>
<th class="head"><p>Ljung-Box p-value</p></th>
<th class="head"><p>Jarque-Bera p-value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Decision Tree</p></td>
<td><p>0.0769</p></td>
<td><p>13,851.18</p></td>
<td><p>0.5688</p></td>
<td><p><strong>0.0</strong></p></td>
<td><p><strong>0.0</strong></p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Errores y Ajuste del Modelo</strong></p>
<ul class="simple">
<li><p><strong>MAPE (Mean Absolute Percentage Error) = 7.69%</strong> ‚Üí Error relativamente bajo.</p></li>
<li><p><strong>RMSE = 13,851.18</strong> ‚Üí Similar a XGBoost, aunque ligeramente peor.</p></li>
<li><p><strong>R¬≤ = 0.5688</strong> ‚Üí Solo <strong>56.88% de la variabilidad</strong> en los datos es explicada por el modelo.</p>
<ul>
<li><p>Esto indica que el modelo no es muy preciso.</p></li>
</ul>
</li>
</ul>
<p><strong>Pruebas de residuos</strong></p>
<ul class="simple">
<li><p><strong>Ljung-Box p-value = 0.0</strong> ‚Üí <strong>Autocorrelaci√≥n alta en los residuos</strong></p>
<ul>
<li><p>Indica que los errores siguen un <strong>patr√≥n predecible</strong>, lo que <strong>viola la suposici√≥n de ruido blanco</strong>.</p></li>
</ul>
</li>
<li><p><strong>Jarque-Bera p-value = 0.0</strong> ‚Üí <strong>Los residuos NO siguen una distribuci√≥n normal</strong></p>
<ul>
<li><p>Esto sugiere que el modelo no captura bien la distribuci√≥n de los datos.</p></li>
</ul>
</li>
</ul>
</section>
<hr class="docutils" />
<section id="analisis-de-los-graficos">
<h2>An√°lisis de los gr√°ficos<a class="headerlink" href="#analisis-de-los-graficos" title="Link to this heading">#</a></h2>
<p><strong>Precio Real vs. Predicho</strong></p>
<ul class="simple">
<li><p>El modelo sigue bien la tendencia inicial.</p></li>
<li><p>Sin embargo, <strong>en valores altos hay un claro sesgo</strong>, el modelo <strong>subestima precios altos</strong>.</p></li>
<li><p>Se observa una tendencia <strong>‚Äúescalonada‚Äù</strong>, lo que indica que el √°rbol no captura bien los cambios r√°pidos.</p></li>
</ul>
<p><strong>Autocorrelaci√≥n de los residuos (ACF Plot)</strong></p>
<ul class="simple">
<li><p><strong>Altos niveles de autocorrelaci√≥n</strong> en los residuos.</p></li>
<li><p>Indica que <strong>hay patrones sin capturar</strong> ‚Üí posible necesidad de m√°s caracter√≠sticas o modelo m√°s complejo.</p></li>
</ul>
<p><strong>Histograma de los residuos</strong></p>
<ul class="simple">
<li><p>Distribuci√≥n <strong>sesgada y bimodal</strong>.</p></li>
<li><p>Indica que hay <strong>dos tipos de errores predominantes</strong>, lo que sugiere que el modelo podr√≠a beneficiarse de una mayor profundidad o de t√©cnicas de suavizado.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="random-forest">
<h1>Random Forest<a class="headerlink" href="#random-forest" title="Link to this heading">#</a></h1>
<section id="definicion-metodo-de-ensemble-que-combina-multiples-arboles-de-decision-entrenados-en-subconjuntos-aleatorios-de-datos-y-caracteristicas">
<h2>Definici√≥n: M√©todo de ensemble que combina m√∫ltiples √°rboles de decisi√≥n entrenados en subconjuntos aleatorios de datos y caracter√≠sticas.<a class="headerlink" href="#definicion-metodo-de-ensemble-que-combina-multiples-arboles-de-decision-entrenados-en-subconjuntos-aleatorios-de-datos-y-caracteristicas" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>

<span class="c1"># Random Forest para datos de 15m (Regresi√≥n)</span>
<span class="n">rf_15m</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">rf_15m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-2 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-2 {
  color: var(--sklearn-color-text);
}

#sk-container-id-2 pre {
  padding: 0;
}

#sk-container-id-2 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-2 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-2 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-2 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-2 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-2 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-2 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-2 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-2 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-2 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-2 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-2 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "‚ñ∏";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-2 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "‚ñæ";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-2 div.sk-label label.sk-toggleable__label,
#sk-container-id-2 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-2 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-2 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-2 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-2 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-2 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-2 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-2 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-2 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomForestRegressor(max_depth=5, random_state=42)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>RandomForestRegressor</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.ensemble.RandomForestRegressor.html">?<span>Documentation for RandomForestRegressor</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted"><pre>RandomForestRegressor(max_depth=5, random_state=42)</pre></div> </div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">normaltest</span>

<span class="c1"># Predecir</span>
<span class="n">rf_pred_15m</span> <span class="o">=</span> <span class="n">rf_15m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_15m</span><span class="p">)</span>

<span class="c1"># Calcular m√©tricas</span>
<span class="n">rf_mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">rf_pred_15m</span><span class="p">)</span>
<span class="n">rf_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">rf_pred_15m</span><span class="p">))</span>
<span class="n">rf_r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">rf_pred_15m</span><span class="p">)</span>

<span class="c1"># Calcular residuos</span>
<span class="n">residuos</span> <span class="o">=</span> <span class="n">y_test_15m</span> <span class="o">-</span> <span class="n">rf_pred_15m</span>

<span class="c1"># Test de Ljung-Box (autocorrelaci√≥n)</span>
<span class="n">ljungbox_pvalue</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuos</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Test de Jarque-Bera (normalidad)</span>
<span class="n">jb_pvalue</span> <span class="o">=</span> <span class="n">normaltest</span><span class="p">(</span><span class="n">residuos</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Resultados en DataFrame</span>
<span class="n">resultados_rf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Random Forest&#39;</span><span class="p">],</span>
    <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">rf_mape</span><span class="p">],</span>
    <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">rf_rmse</span><span class="p">],</span>
    <span class="s1">&#39;R¬≤&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">rf_r2</span><span class="p">],</span>
    <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">ljungbox_pvalue</span><span class="p">],</span>
    <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">jb_pvalue</span><span class="p">]</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Resultados Random Forest (15m) ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">resultados_rf</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Resultados Random Forest (15m) ===
       Modelo     MAPE         RMSE       R¬≤  Ljung-Box p-value  Jarque-Bera p-value
Random Forest 0.075528 13842.742237 0.569306                0.0                  0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Asegurar alineaci√≥n de √≠ndices</span>
<span class="n">rf_pred_15m</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rf_15m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_15m</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">y_test_15m</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Gr√°ficas con configuraci√≥n mejorada</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># 1Ô∏è‚É£ Precio Real vs. Predicho (con ejes claros)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Real&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rf_pred_15m</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Predicho&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Precio Real vs. Predicho&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Tiempo&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Precio (USD)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># 2Ô∏è‚É£ ACF de residuos</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">residuos</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>  <span class="c1"># Ajusta lags seg√∫n necesidad</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Autocorrelaci√≥n de Residuos&quot;</span><span class="p">)</span>

<span class="c1"># 3Ô∏è‚É£ Histograma de residuos (bins y ejes ajustados)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">residuos</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribuci√≥n de Residuos&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Error de Predicci√≥n (USD)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/671516560573530393429b5fc62e38fa35a931c73700a4af8c8dd0b7b8c301d4.png" src="_images/671516560573530393429b5fc62e38fa35a931c73700a4af8c8dd0b7b8c301d4.png" />
</div>
</div>
</section>
<section id="analisis-del-modelo-random-forest-rf">
<h2>An√°lisis del modelo Random Forest (RF)<a class="headerlink" href="#analisis-del-modelo-random-forest-rf" title="Link to this heading">#</a></h2>
<p>A partir de los resultados obtenidos y las gr√°ficas de diagn√≥stico, podemos analizar el desempe√±o del modelo.</p>
<hr class="docutils" />
<section id="metricas-del-modelo">
<h3><strong>M√©tricas del modelo</strong><a class="headerlink" href="#metricas-del-modelo" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>M√©trica</p></th>
<th class="head"><p>Valor</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>MAPE</strong> (Error porcentual absoluto medio)</p></td>
<td><p>0.0757</p></td>
</tr>
<tr class="row-odd"><td><p><strong>RMSE</strong> (Error cuadr√°tico medio)</p></td>
<td><p>13,856.9891</p></td>
</tr>
<tr class="row-even"><td><p><strong>R¬≤</strong> (Coeficiente de determinaci√≥n)</p></td>
<td><p>0.5684</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p><strong>MAPE = 7.57%</strong> ‚Üí Indica que, en promedio, las predicciones tienen un error del 7.57% con respecto a los valores reales.</p></li>
<li><p><strong>RMSE = 13,856</strong> ‚Üí Muestra el error promedio en unidades monetarias (probablemente en d√≥lares).</p></li>
<li><p><strong>R¬≤ = 0.5684</strong> ‚Üí Solo <strong>el 56.84% de la variabilidad</strong> en los datos es explicada por el modelo. <strong>No es un valor alto</strong>, lo que sugiere que hay margen de mejora.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="interpretacion-de-las-graficas">
<h3><strong>Interpretaci√≥n de las gr√°ficas</strong><a class="headerlink" href="#interpretacion-de-las-graficas" title="Link to this heading">#</a></h3>
<section id="precio-real-vs-predicho-grafico-de-la-izquierda">
<h4><strong>1. Precio Real vs. Predicho</strong> (Gr√°fico de la izquierda)<a class="headerlink" href="#precio-real-vs-predicho-grafico-de-la-izquierda" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Predicciones (rojo) parecen estar subestimando valores altos</strong>.</p></li>
<li><p><strong>Modelo pierde precisi√≥n en tendencias alcistas</strong> ‚Üí Posiblemente por la profundidad limitada del √°rbol (<code class="docutils literal notranslate"><span class="pre">max_depth=5</span></code>).</p></li>
<li><p><strong>Divergencia entre valores reales y predichos</strong> ‚Üí No se adapta bien a movimientos bruscos del mercado.</p></li>
</ul>
</section>
<section id="acf-de-los-residuos-grafico-del-centro">
<h4><strong>2. ACF de los residuos</strong> (Gr√°fico del centro)<a class="headerlink" href="#acf-de-los-residuos-grafico-del-centro" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>La autocorrelaci√≥n es muy alta en todos los rezagos</strong>  ‚Üí <strong>No es un buen signo.</strong></p></li>
<li><p>Indica que <strong>los errores no son ruido blanco</strong>, lo que significa que el modelo deja informaci√≥n sin capturar.</p></li>
<li><p><strong>Sugiere que el modelo podr√≠a mejorar incluyendo m√°s variables o t√©cnicas de modelado de series temporales</strong>.</p></li>
</ul>
</section>
<section id="histograma-de-los-residuos-grafico-de-la-derecha">
<h4><strong>3. Histograma de los residuos</strong> (Gr√°fico de la derecha)<a class="headerlink" href="#histograma-de-los-residuos-grafico-de-la-derecha" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Sesgo a la derecha</strong> ‚Üí Indica que hay <strong>valores at√≠picos o errores grandes en ciertas predicciones</strong>.</p></li>
<li><p><strong>Posibles colas largas</strong> ‚Üí El modelo podr√≠a estar <strong>subestimando valores altos o sobreestimando valores bajos</strong>.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="conclusion">
<h3><strong>Conclusi√≥n</strong><a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h3>
<p><strong>Random Forest tiene un rendimiento similar al Decision Tree, pero con ligeras mejoras en MAPE y R¬≤.</strong><br />
<strong>El modelo NO captura bien la estructura de los datos, dejando residuos autocorrelacionados</strong>.<br />
<strong>Sigue presentando problemas de distribuci√≥n de errores, lo que indica falta de ajuste en algunos valores.</strong></p>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="xgboost">
<h1>XGBoost<a class="headerlink" href="#xgboost" title="Link to this heading">#</a></h1>
<section id="definicion-algoritmo-de-boosting-que-combina-secuencialmente-modelos-debiles-normalmente-arboles-corrigiendo-los-errores-de-los-modelos-anteriores">
<h2>Definici√≥n: Algoritmo de boosting que combina secuencialmente modelos d√©biles (normalmente √°rboles) corrigiendo los errores de los modelos anteriores.<a class="headerlink" href="#definicion-algoritmo-de-boosting-que-combina-secuencialmente-modelos-debiles-normalmente-arboles-corrigiendo-los-errores-de-los-modelos-anteriores" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ensure xgboost is installed</span>
<span class="o">%</span><span class="k">pip</span> install xgboost

<span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="nn">xgb</span>


<span class="c1"># XGBoost para datos de 15 minutos (Regresi√≥n)</span>
<span class="n">xgb_15m</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">XGBRegressor</span><span class="p">(</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">tree_method</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span>  <span class="c1"># M√©todo optimizado</span>
    <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
<span class="n">xgb_15m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">X_train_15m</span><span class="p">,</span> 
    <span class="n">y_train_15m</span><span class="p">,</span>
    <span class="n">eval_set</span><span class="o">=</span><span class="p">[(</span><span class="n">X_test_15m</span><span class="p">,</span> <span class="n">y_test_15m</span><span class="p">)],</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: xgboost in /Users/elianafuentes/miniconda3/envs/ml_venv/lib/python3.9/site-packages (2.1.4)
Requirement already satisfied: numpy in /Users/elianafuentes/miniconda3/envs/ml_venv/lib/python3.9/site-packages (from xgboost) (1.26.4)
Requirement already satisfied: scipy in /Users/elianafuentes/miniconda3/envs/ml_venv/lib/python3.9/site-packages (from xgboost) (1.13.1)
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
<div class="output text_html"><style>#sk-container-id-5 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-5 {
  color: var(--sklearn-color-text);
}

#sk-container-id-5 pre {
  padding: 0;
}

#sk-container-id-5 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-5 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-5 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-5 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-5 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-5 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-5 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-5 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-5 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-5 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-5 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-5 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-5 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-5 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-5 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "‚ñ∏";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-5 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-5 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-5 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-5 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "‚ñæ";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-5 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-5 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-5 div.sk-label label.sk-toggleable__label,
#sk-container-id-5 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-5 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-5 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-5 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-5 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-5 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-5 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-5 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-5 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-5 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-5 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-5 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-5" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>XGBRegressor(base_score=None, booster=None, callbacks=None,
             colsample_bylevel=None, colsample_bynode=None,
             colsample_bytree=None, device=None, early_stopping_rounds=10,
             enable_categorical=False, eval_metric=&#x27;rmse&#x27;, feature_types=None,
             gamma=None, grow_policy=None, importance_type=None,
             interaction_constraints=None, learning_rate=None, max_bin=None,
             max_cat_threshold=None, max_cat_to_onehot=None,
             max_delta_step=None, max_depth=3, max_leaves=None,
             min_child_weight=None, missing=nan, monotone_constraints=None,
             multi_strategy=None, n_estimators=100, n_jobs=None,
             num_parallel_tree=None, random_state=42, ...)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" checked><label for="sk-estimator-id-5" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>XGBRegressor</div></div><div><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted"><pre>XGBRegressor(base_score=None, booster=None, callbacks=None,
             colsample_bylevel=None, colsample_bynode=None,
             colsample_bytree=None, device=None, early_stopping_rounds=10,
             enable_categorical=False, eval_metric=&#x27;rmse&#x27;, feature_types=None,
             gamma=None, grow_policy=None, importance_type=None,
             interaction_constraints=None, learning_rate=None, max_bin=None,
             max_cat_threshold=None, max_cat_to_onehot=None,
             max_delta_step=None, max_depth=3, max_leaves=None,
             min_child_weight=None, missing=nan, monotone_constraints=None,
             multi_strategy=None, n_estimators=100, n_jobs=None,
             num_parallel_tree=None, random_state=42, ...)</pre></div> </div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -------------------------------------------</span>
<span class="c1"># 1. PREDICCIONES Y RESIDUOS (CON VALIDACI√ìN)</span>
<span class="c1"># -------------------------------------------</span>

<span class="c1"># Asegurar alineaci√≥n de √≠ndices</span>
<span class="n">y_pred_xgb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
    <span class="n">xgb_15m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_15m</span><span class="p">),</span> 
    <span class="n">index</span><span class="o">=</span><span class="n">y_test_15m</span><span class="o">.</span><span class="n">index</span>  <span class="c1"># Mantener alineaci√≥n temporal</span>
<span class="p">)</span>

<span class="n">residuals_xgb</span> <span class="o">=</span> <span class="n">y_test_15m</span> <span class="o">-</span> <span class="n">y_pred_xgb</span>

<span class="c1"># -------------------------------------------</span>
<span class="c1"># 2. M√âTRICAS DE EVALUACI√ìN (CON VALIDACI√ìN)</span>
<span class="c1"># -------------------------------------------</span>

<span class="c1"># Calcular m√©tricas b√°sicas</span>
<span class="n">mape_xgb</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_xgb</span><span class="p">)</span>
<span class="n">rmse_xgb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_xgb</span><span class="p">))</span>
<span class="n">r2_xgb</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_xgb</span><span class="p">)</span>

<span class="c1"># Pruebas estad√≠sticas</span>
<span class="n">ljung_box_result_xgb</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals_xgb</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ljung_box_pvalue_xgb</span> <span class="o">=</span> <span class="n">ljung_box_result_xgb</span><span class="p">[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Jarque-Bera</span>
<span class="n">jb_test_xgb</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">stattools</span><span class="o">.</span><span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals_xgb</span><span class="p">)</span>
<span class="n">jb_pvalue_xgb</span> <span class="o">=</span> <span class="n">jb_test_xgb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># -------------------------------------------</span>
<span class="c1"># 3. TABLA DE RESULTADOS</span>
<span class="c1"># -------------------------------------------</span>
<span class="n">results_xgb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;XGBoost&#39;</span><span class="p">],</span>
    <span class="s1">&#39;MAPE (%)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mape_xgb</span> <span class="o">*</span> <span class="mi">100</span><span class="p">],</span>
    <span class="s1">&#39;RMSE (USD)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">rmse_xgb</span><span class="p">],</span>
    <span class="s1">&#39;R¬≤&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">r2_xgb</span><span class="p">],</span>
    <span class="s1">&#39;Ljung-Box (p-val)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">ljung_box_pvalue_xgb</span><span class="p">],</span>
    <span class="s1">&#39;Normalidad (p-val)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">jb_pvalue_xgb</span><span class="p">]</span>
<span class="p">})</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">RESULTADOS DEL MODELO (XGBOOST):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_xgb</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># -------------------------------------------</span>
<span class="c1"># 4. GR√ÅFICAS ACTUALIZADAS</span>
<span class="c1"># -------------------------------------------</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># A. Precio Real vs. Predicho</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Real&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred_xgb</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Predicho&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Precio Real vs. Predicho (XGBoost)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;√çndice Temporal&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Precio (USD)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># B. Autocorrelaci√≥n de residuos</span>
<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">residuals_xgb</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Autocorrelaci√≥n de Residuos&quot;</span><span class="p">)</span>

<span class="c1"># C. Histograma de residuos</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">residuals_xgb</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribuci√≥n de Residuos&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Error de Predicci√≥n (USD)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RESULTADOS DEL MODELO (XGBOOST):
 Modelo  MAPE (%)  RMSE (USD)     R¬≤  Ljung-Box (p-val)  Normalidad (p-val)
XGBoost    6.8076  13441.1479 0.5939                0.0                 0.0
</pre></div>
</div>
<img alt="_images/b65490346049c54cd37c5764682d29fc33bb689efdffb130873b58f9e8247d14.png" src="_images/b65490346049c54cd37c5764682d29fc33bb689efdffb130873b58f9e8247d14.png" />
</div>
</div>
</section>
<section id="evaluacion-del-modelo-xgboost">
<h2>Evaluaci√≥n del Modelo XGBoost<a class="headerlink" href="#evaluacion-del-modelo-xgboost" title="Link to this heading">#</a></h2>
<p>Los resultados obtenidos para el modelo <strong>XGBoost</strong> con datos de 15 minutos fueron los siguientes:</p>
<ul class="simple">
<li><p><strong>MAPE</strong>: 0.0698 ‚Üí Error porcentual del <strong>6.98%</strong></p></li>
<li><p><strong>RMSE</strong>: 13,479.19 ‚Üí Error cuadr√°tico medio</p></li>
<li><p><strong>R¬≤</strong>: 0.5916 ‚Üí El modelo explica el <strong>59.16%</strong> de la variabilidad del precio</p></li>
</ul>
<section id="comparacion-con-otros-modelos">
<h3>Comparaci√≥n con otros modelos<a class="headerlink" href="#comparacion-con-otros-modelos" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Modelo</p></th>
<th class="head"><p>MAPE</p></th>
<th class="head"><p>RMSE</p></th>
<th class="head"><p>R¬≤</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Random Forest</p></td>
<td><p>0.0757</p></td>
<td><p>13,856.99</p></td>
<td><p>0.5684</p></td>
</tr>
<tr class="row-odd"><td><p>XGBoost</p></td>
<td><p>0.0698</p></td>
<td><p>13,479.19</p></td>
<td><p>0.5916</p></td>
</tr>
</tbody>
</table>
</div>
<p>** Observaciones:**<br />
XGBoost mejora ligeramente el rendimiento de Random Forest en todas las m√©tricas.<br />
La diferencia entre modelos es <strong>peque√±a</strong>, lo que sugiere que pueden estar usando informaci√≥n similar.<br />
El <strong>R¬≤ sigue siendo bajo (59.16%)</strong>, lo que indica que hay factores no capturados por el modelo.</p>
</section>
</section>
<hr class="docutils" />
<section id="id5">
<h2>Algoritmo de Optimizacion<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<section id="xgboost-tree-method-hist-y-early-stopping-rounds">
<h3>XGBoost ‚Üí tree_method=‚Äôhist‚Äô y early_stopping_rounds.<a class="headerlink" href="#xgboost-tree-method-hist-y-early-stopping-rounds" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="nn">xgb</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Configuraci√≥n √≥ptima para XGBoost en regresi√≥n</span>
<span class="n">xgb_optimized_15m</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">XGBRegressor</span><span class="p">(</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">max_depth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>  <span class="c1"># Menor profundidad para datos m√°s ruidosos</span>
    <span class="n">tree_method</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span>
    <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>  <span class="c1"># M√°s sensible para datos de alta frecuencia</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>  <span class="c1"># Tasa de aprendizaje m√°s alta</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># Entrenamiento con medici√≥n de tiempo</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">xgb_optimized_15m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">X_train_15m</span><span class="p">,</span>
    <span class="n">y_train_15m</span><span class="p">,</span>
    <span class="n">eval_set</span><span class="o">=</span><span class="p">[(</span><span class="n">X_test_15m</span><span class="p">,</span> <span class="n">y_test_15m</span><span class="p">)],</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">10</span>
<span class="p">)</span>
<span class="n">time_15m</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tiempos de entrenamiento optimizados:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;15min: </span><span class="si">{</span><span class="n">time_15m</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s (Detenido en </span><span class="si">{</span><span class="n">xgb_optimized_15m</span><span class="o">.</span><span class="n">best_iteration</span><span class="si">}</span><span class="s2"> iteraciones)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0]	validation_0-rmse:41994.28851
[10]	validation_0-rmse:22838.30763
[20]	validation_0-rmse:16399.69659
[30]	validation_0-rmse:14414.33824
[40]	validation_0-rmse:13796.64052
[50]	validation_0-rmse:13590.67107
[60]	validation_0-rmse:13499.45891
[70]	validation_0-rmse:13453.24938
[80]	validation_0-rmse:13432.37986
[90]	validation_0-rmse:13424.22195
[100]	validation_0-rmse:13422.82930
[110]	validation_0-rmse:13422.13765
[120]	validation_0-rmse:13422.70925
[130]	validation_0-rmse:13422.86990
[140]	validation_0-rmse:13421.73642
[148]	validation_0-rmse:13422.38392

Tiempos de entrenamiento optimizados:
15min: 0.92s (Detenido en 119 iteraciones)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id6">
<h2>Conclusiones<a class="headerlink" href="#id6" title="Link to this heading">#</a></h2>
</section>
<section id="xgboost-optimizado">
<h2>XGBoost Optimizado<a class="headerlink" href="#xgboost-optimizado" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Se observa una mejora sustancial del RMSE desde 41,994.29 hasta 13,422.38 (68% de reducci√≥n).</p></li>
<li><p>La convergencia es r√°pida en las primeras 20 iteraciones y se estabiliza despu√©s de 50 iteraciones.</p></li>
<li><p>La implementaci√≥n optimizada con tree_method=‚Äôhist‚Äô y early_stopping result√≥ computacionalmente eficiente (0.92s).</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="svm-support-vector-machines">
<h1>SVM (Support Vector Machines)<a class="headerlink" href="#svm-support-vector-machines" title="Link to this heading">#</a></h1>
<section id="definicion-algoritmo-que-encuentra-el-hiperplano-optimo-en-un-espacio-dimensional-alto-que-maximiza-el-margen-entre-clases">
<h2>Definici√≥n: Algoritmo que encuentra el hiperplano √≥ptimo en un espacio dimensional alto que maximiza el margen entre clases.<a class="headerlink" href="#definicion-algoritmo-que-encuentra-el-hiperplano-optimo-en-un-espacio-dimensional-alto-que-maximiza-el-margen-entre-clases" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>

<span class="c1"># SVM para datos de 15m</span>
<span class="n">svm_15m</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>
<span class="n">svm_15m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-7 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-7 {
  color: var(--sklearn-color-text);
}

#sk-container-id-7 pre {
  padding: 0;
}

#sk-container-id-7 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-7 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-7 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-7 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-7 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-7 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-7 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-7 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-7 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-7 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-7 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-7 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-7 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-7 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-7 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "‚ñ∏";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-7 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-7 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-7 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-7 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-7 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-7 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-7 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "‚ñæ";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-7 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-7 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-7 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-7 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-7 div.sk-label label.sk-toggleable__label,
#sk-container-id-7 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-7 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-7 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-7 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-7 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-7 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-7 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-7 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-7 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-7 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-7 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-7 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-7 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-7" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>SVR()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-9" type="checkbox" checked><label for="sk-estimator-id-9" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>SVR</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.svm.SVR.html">?<span>Documentation for SVR</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted"><pre>SVR()</pre></div> </div></div></div></div></div></div>
</div>
</section>
<section id="id7">
<h2>Algoritmo de optimizacion<a class="headerlink" href="#id7" title="Link to this heading">#</a></h2>
<section id="linearsvc-en-vez-de-svc-kernel-linear-rbf-con-random-fourier-features">
<h3>LinearSVC en vez de SVC(kernel=‚Äôlinear‚Äô), RBF con Random Fourier Features<a class="headerlink" href="#linearsvc-en-vez-de-svc-kernel-linear-rbf-con-random-fourier-features" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">LinearSVR</span><span class="p">,</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.kernel_approximation</span> <span class="kn">import</span> <span class="n">RBFSampler</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>

<span class="c1"># 1. LinearSVR (SVM sin kernel para regresi√≥n)</span>

<span class="n">linear_svr_15m</span> <span class="o">=</span> <span class="n">LinearSVR</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">linear_svr_15m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">)</span>

<span class="c1"># 2. SGDRegressor (SVM optimizado con Stochastic Gradient Descent)</span>

<span class="n">sgd_svr_15m</span> <span class="o">=</span> <span class="n">SGDRegressor</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="s1">&#39;adaptive&#39;</span><span class="p">,</span> <span class="n">eta0</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">sgd_svr_15m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">)</span>

<span class="c1"># 3. RBF Kernel con Random Fourier Features (Aproximaci√≥n eficiente del kernel RBF)</span>
<span class="n">rbf_svr_15m</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">RBFSampler</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span> <span class="n">SGDRegressor</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">))</span>
<span class="n">rbf_svr_15m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/elianafuentes/miniconda3/envs/ml_venv/lib/python3.9/site-packages/sklearn/svm/_base.py:1249: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.
  warnings.warn(
</pre></div>
</div>
<div class="output text_html"><style>#sk-container-id-6 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-6 {
  color: var(--sklearn-color-text);
}

#sk-container-id-6 pre {
  padding: 0;
}

#sk-container-id-6 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-6 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-6 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-6 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-6 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-6 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-6 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-6 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-6 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-6 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-6 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-6 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-6 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-6 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-6 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "‚ñ∏";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-6 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-6 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-6 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-6 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-6 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-6 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-6 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "‚ñæ";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-6 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-6 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-6 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-6 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-6 div.sk-label label.sk-toggleable__label,
#sk-container-id-6 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-6 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-6 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-6 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-6 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-6 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-6 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-6 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-6 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-6 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-6 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-6 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-6 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-6" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;rbfsampler&#x27;, RBFSampler(n_components=500, random_state=42)),
                (&#x27;sgdregressor&#x27;, SGDRegressor(max_iter=10000))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox" ><label for="sk-estimator-id-6" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>Pipeline</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.pipeline.Pipeline.html">?<span>Documentation for Pipeline</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted"><pre>Pipeline(steps=[(&#x27;rbfsampler&#x27;, RBFSampler(n_components=500, random_state=42)),
                (&#x27;sgdregressor&#x27;, SGDRegressor(max_iter=10000))])</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox" ><label for="sk-estimator-id-7" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>RBFSampler</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.kernel_approximation.RBFSampler.html">?<span>Documentation for RBFSampler</span></a></div></label><div class="sk-toggleable__content fitted"><pre>RBFSampler(n_components=500, random_state=42)</pre></div> </div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox" ><label for="sk-estimator-id-8" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>SGDRegressor</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.linear_model.SGDRegressor.html">?<span>Documentation for SGDRegressor</span></a></div></label><div class="sk-toggleable__content fitted"><pre>SGDRegressor(max_iter=10000)</pre></div> </div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -------------------------------------------</span>
<span class="c1"># 5. COMPARACI√ìN DE MODELOS</span>
<span class="c1"># -------------------------------------------</span>

<span class="c1"># Calcular predicciones y residuos para SVM</span>
<span class="n">y_pred_svm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">svm_15m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_15m</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">y_test_15m</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">residuals_svm</span> <span class="o">=</span> <span class="n">y_test_15m</span> <span class="o">-</span> <span class="n">y_pred_svm</span>

<span class="c1"># Crear DataFrame con m√©tricas para SVM</span>
<span class="n">results_svm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
	<span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SVM (RBF)&#39;</span><span class="p">],</span>
	<span class="s1">&#39;MAPE (%)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_svm</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">],</span>
	<span class="s1">&#39;RMSE (USD)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_svm</span><span class="p">))],</span>
	<span class="s1">&#39;R¬≤&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred_svm</span><span class="p">)],</span>
	<span class="s1">&#39;Ljung-Box (p-val)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals_svm</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
	<span class="s1">&#39;Jarque-Bera (p-val)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals_svm</span><span class="p">)[</span><span class="mi">1</span><span class="p">]]</span>
<span class="p">})</span>

<span class="c1"># Crear DataFrame con todos los resultados</span>
<span class="n">results_combined</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">results_xgb</span><span class="p">,</span> <span class="n">results_svm</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">RESULTADOS COMPARATIVOS (MODELOS NO LINEALES):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_combined</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># Gr√°fica comparativa</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># XGBoost (fila superior)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Real&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred_xgb</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;XGBoost&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Predicciones: XGBoost&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">residuals_xgb</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Autocorrelaci√≥n Residuos (XGBoost)&quot;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">residuals_xgb</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribuci√≥n Residuos (XGBoost)&quot;</span><span class="p">)</span>

<span class="c1"># SVR (fila inferior)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Real&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_pred_svm</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;SVR&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Predicciones: SVR (RBF)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">plot_acf</span><span class="p">(</span><span class="n">residuals_svm</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Autocorrelaci√≥n Residuos (SVR)&quot;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">residuals_svm</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;purple&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribuci√≥n Residuos (SVR)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RESULTADOS COMPARATIVOS (MODELOS NO LINEALES):
   Modelo  MAPE (%)   RMSE (USD)       R¬≤  Ljung-Box (p-val)  Normalidad (p-val)  Jarque-Bera (p-val)
  XGBoost  6.807600 13441.147900  0.59390                0.0                 0.0                  NaN
SVM (RBF) 28.665414 32892.575278 -1.43176                0.0                 NaN                  0.0
</pre></div>
</div>
<img alt="_images/16e503d82b1d2a87611b6fa2b69c6e84a52b36873a26b107c6a89e7808ee1443.png" src="_images/16e503d82b1d2a87611b6fa2b69c6e84a52b36873a26b107c6a89e7808ee1443.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="resultados">
<h1>Resultados<a class="headerlink" href="#resultados" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.stattools</span> <span class="kn">import</span> <span class="n">jarque_bera</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">SGDRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>

<span class="c1"># Modelos optimizados de regresi√≥n</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;KNN (KD-Tree)&quot;</span><span class="p">:</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;kd_tree&#39;</span><span class="p">),</span>
    <span class="s2">&quot;Ridge (SAGA)&quot;</span><span class="p">:</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;saga&#39;</span><span class="p">),</span>
    <span class="s2">&quot;Lasso (SAGA)&quot;</span><span class="p">:</span> <span class="n">Lasso</span><span class="p">(),</span>
    <span class="s2">&quot;XGBoost (hist)&quot;</span><span class="p">:</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">tree_method</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">),</span>
    <span class="s2">&quot;SGD Regressor&quot;</span><span class="p">:</span> <span class="n">SGDRegressor</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;squared_error&#39;</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">),</span>
    <span class="s2">&quot;SVM (RBF Kernel)&quot;</span><span class="p">:</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>  <span class="c1"># Se usa RBF para capturar relaciones no lineales</span>
<span class="p">}</span>

<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">residuals_dict</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="c1"># Entrenamiento</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_15m</span><span class="p">,</span> <span class="n">y_train_15m</span><span class="p">)</span>
    <span class="n">train_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

    <span class="c1"># Predicci√≥n</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_15m</span><span class="p">)</span>
    <span class="n">pred_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

    <span class="c1"># C√°lculo de residuos</span>
    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test_15m</span> <span class="o">-</span> <span class="n">y_pred</span>
    <span class="n">residuals_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">residuals</span>  <span class="c1"># Guardamos para an√°lisis gr√°fico</span>

    <span class="c1"># M√©tricas de regresi√≥n</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test_15m</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

    <span class="c1"># Prueba de Ljung-Box para autocorrelaci√≥n en los residuos</span>
    <span class="n">ljung_box_p</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s2">&quot;lb_pvalue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Prueba de Jarque-Bera para normalidad de los residuos</span>
    <span class="n">jb_p</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;Modelo&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
        <span class="s2">&quot;Tiempo Entrenamiento&quot;</span><span class="p">:</span> <span class="n">train_time</span><span class="p">,</span>
        <span class="s2">&quot;Tiempo Predicci√≥n&quot;</span><span class="p">:</span> <span class="n">pred_time</span><span class="p">,</span>
        <span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s2">&quot;R¬≤&quot;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s2">&quot;Ljung-Box p-value&quot;</span><span class="p">:</span> <span class="n">ljung_box_p</span><span class="p">,</span>
        <span class="s2">&quot;Jarque-Bera p-value&quot;</span><span class="p">:</span> <span class="n">jb_p</span>
    <span class="p">})</span>

<span class="c1"># Resultados comparativos</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;R¬≤&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># üìà Gr√°ficos de ACF de los residuos y Histogramas</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">residuals</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">residuals_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="c1"># ACF de los residuos</span>
    <span class="n">plot_acf</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ACF de los Residuos - </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="c1"># Histograma de los residuos</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Histograma de los Residuos - </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/elianafuentes/miniconda3/envs/ml_venv/lib/python3.9/site-packages/sklearn/linear_model/_sag.py:348: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>             Modelo  Tiempo Entrenamiento  Tiempo Predicci√≥n          MAPE  \
1      Ridge (SAGA)             24.540766           0.002232  2.080298e-03   
2      Lasso (SAGA)              0.554995           0.009260  3.196857e-03   
0     KNN (KD-Tree)              0.096972           0.321819  5.664482e-02   
3    XGBoost (hist)              0.320785           0.016236  6.664286e-02   
5  SVM (RBF Kernel)           3082.549994         358.564882  2.866541e-01   
4     SGD Regressor              7.517276           0.002789  8.570014e+12   

           RMSE            R¬≤  Ljung-Box p-value  Jarque-Bera p-value  
1  2.207935e+02  9.998904e-01                0.0         0.000000e+00  
2  3.418319e+02  9.997374e-01                0.0         0.000000e+00  
0  1.237349e+04  6.558805e-01                0.0         0.000000e+00  
3  1.340696e+04  5.959958e-01                0.0         0.000000e+00  
5  3.289258e+04 -1.431760e+00                0.0         0.000000e+00  
4  5.546766e+17 -6.915199e+26                0.0        5.352822e-303  
</pre></div>
</div>
<img alt="_images/c617555d8321c4fcfeb6c8544437562f912e41e5447775254931347b14b40cda.png" src="_images/c617555d8321c4fcfeb6c8544437562f912e41e5447775254931347b14b40cda.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="analisis-comparativo-de-modelos-de-regresion">
<h1>An√°lisis Comparativo de Modelos de Regresi√≥n<a class="headerlink" href="#analisis-comparativo-de-modelos-de-regresion" title="Link to this heading">#</a></h1>
<section id="resumen-de-rendimiento">
<h2>Resumen de Rendimiento<a class="headerlink" href="#resumen-de-rendimiento" title="Link to this heading">#</a></h2>
<p>El an√°lisis comparativo de los seis modelos evaluados revela diferencias significativas en t√©rminos de precisi√≥n, eficiencia computacional y caracter√≠sticas de los residuos.</p>
<section id="precision-predictiva-ordenados-de-mejor-a-peor">
<h3>Precisi√≥n Predictiva (ordenados de mejor a peor)<a class="headerlink" href="#precision-predictiva-ordenados-de-mejor-a-peor" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Ridge (SAGA)</strong>: Destaca como el modelo con mejor rendimiento general con un MAPE extraordinariamente bajo (0.00208%), RMSE de 220.79 y R¬≤ de 0.9999</p></li>
<li><p><strong>Lasso (SAGA)</strong>: Segundo mejor modelo con m√©tricas muy cercanas a Ridge (MAPE 0.00320%, RMSE 341.83, R¬≤ 0.9997)</p></li>
<li><p><strong>KNN (KD-Tree)</strong>: Muestra un rendimiento moderado (MAPE 5.66%, RMSE 12,373.49, R¬≤ 0.6559)</p></li>
<li><p><strong>XGBoost (hist)</strong>: Ligeramente inferior a KNN (MAPE 6.66%, RMSE 13,406.96, R¬≤ 0.5960)</p></li>
<li><p><strong>SVM (RBF Kernel)</strong>: Rendimiento deficiente con R¬≤ negativo (-1.4318), indicando que el modelo es peor que un simple promedio</p></li>
<li><p><strong>SGD Regressor</strong>: Rendimiento catastr√≥fico con valores extremos en MAPE (8.57√ó10¬π¬≤) y R¬≤ (-6.92√ó10¬≤‚Å∂)</p></li>
</ol>
</section>
<section id="eficiencia-computacional">
<h3>Eficiencia Computacional<a class="headerlink" href="#eficiencia-computacional" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>KNN (KD-Tree)</strong>: El m√°s r√°pido en entrenamiento (0.097s)</p></li>
<li><p><strong>XGBoost (hist)</strong>: Segundo m√°s r√°pido en entrenamiento (0.321s)</p></li>
<li><p><strong>Lasso (SAGA)</strong>: Entrenamiento r√°pido (0.555s) y predicci√≥n muy r√°pida (0.009s)</p></li>
<li><p><strong>Ridge (SAGA)</strong>: Entrenamiento moderado (24.54s) con predicci√≥n ultrarr√°pida (0.002s)</p></li>
<li><p><strong>SGD Regressor</strong>: Entrenamiento moderado (7.52s)</p></li>
<li><p><strong>SVM (RBF Kernel)</strong>: Extremadamente lento (3082.55s ‚âà 51 minutos) con predicciones tambi√©n muy lentas (358.56s)</p></li>
</ol>
</section>
</section>
<section id="id8">
<h2>An√°lisis de Residuos<a class="headerlink" href="#id8" title="Link to this heading">#</a></h2>
<section id="autocorrelacion-acf">
<h3>Autocorrelaci√≥n (ACF)<a class="headerlink" href="#autocorrelacion-acf" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Ridge (SAGA)</strong>: Muestra autocorrelaci√≥n significativa solo en el primer rezago, indicando que captura bien la estructura temporal</p></li>
<li><p><strong>Lasso (SAGA)</strong>: Presenta autocorrelaci√≥n en m√∫ltiples rezagos (aproximadamente hasta el 7¬∫)</p></li>
<li><p><strong>KNN, XGBoost, SVM, SGD</strong>: Todos muestran fuerte autocorrelaci√≥n en todos los rezagos, se√±alando que no capturan adecuadamente la estructura temporal de los datos</p></li>
</ol>
</section>
<section id="distribucion-de-residuos">
<h3>Distribuci√≥n de Residuos<a class="headerlink" href="#distribucion-de-residuos" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Ridge y Lasso</strong>: Distribuciones sim√©tricas, centradas en cero, con poca dispersi√≥n</p></li>
<li><p><strong>KNN y XGBoost</strong>: Distribuciones relativamente sim√©tricas pero con mayor dispersi√≥n</p></li>
<li><p><strong>SVM</strong>: Distribuci√≥n multimodal con varios picos, indicando problemas sistem√°ticos en la predicci√≥n</p></li>
<li><p><strong>SGD Regressor</strong>: Distribuci√≥n altamente irregular con m√∫ltiples modas y valores at√≠picos extremos</p></li>
</ol>
</section>
</section>
<section id="conclusiones-clave">
<h2>Conclusiones Clave<a class="headerlink" href="#conclusiones-clave" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Superioridad de los Modelos Lineales</strong>:</p>
<ul class="simple">
<li><p>Ridge y Lasso superan ampliamente a los modelos no lineales m√°s complejos para este conjunto de datos</p></li>
<li><p>La regularizaci√≥n utilizada (SAGA) demuestra ser muy efectiva para este problema</p></li>
</ul>
</li>
<li><p><strong>Relaci√≥n Complejidad-Rendimiento Inversa</strong>:</p>
<ul class="simple">
<li><p>Los modelos m√°s simples (lineales) obtienen mejores resultados que los m√°s complejos</p></li>
<li><p>SVM, a pesar de su alto costo computacional, presenta un rendimiento deplorable</p></li>
</ul>
</li>
<li><p><strong>Problemas en la Especificaci√≥n de Modelos</strong>:</p>
<ul class="simple">
<li><p>Todos los modelos muestran residuos no normales (p-valor Jarque-Bera = 0)</p></li>
<li><p>Los modelos no lineales fallan en capturar la estructura temporal (alta autocorrelaci√≥n)</p></li>
<li><p>SGD Regressor parece estar mal configurado o ser completamente inadecuado para estos datos</p></li>
</ul>
</li>
<li><p><strong>Equilibrio Precisi√≥n-Velocidad</strong>:</p>
<ul class="simple">
<li><p>Ridge ofrece la mejor precisi√≥n con un tiempo de predicci√≥n ultrarr√°pido</p></li>
<li><p>Lasso podr√≠a ser preferible en escenarios donde el tiempo de entrenamiento sea crucial</p></li>
</ul>
</li>
</ol>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modelos-para-volatilidad">
<h1>Modelos para Volatilidad<a class="headerlink" href="#modelos-para-volatilidad" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">prepare_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">lookback</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Versi√≥n corregida con manejo completo de NaN y validaci√≥n de datos.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Validar columnas necesarias</span>
    <span class="n">required_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">,</span> <span class="s1">&#39;Volume&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">required_cols</span><span class="p">):</span>
        <span class="n">missing</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">required_cols</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Faltan columnas: </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="c1"># 1. Retornos porcentuales</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Returns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
    
    <span class="c1"># 2. C√°lculo de volatilidad con manejo de ventanas</span>
    <span class="n">min_periods_vol</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">lookback</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">))</span>  <span class="c1"># M√≠nimo 30% de la ventana</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Historical_Volatility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Returns&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span>
        <span class="n">window</span><span class="o">=</span><span class="n">lookback</span><span class="p">,</span> 
        <span class="n">min_periods</span><span class="o">=</span><span class="n">min_periods_vol</span>
    <span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    
    <span class="c1"># 3. Volatilidad futura con shift controlado</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Future_Volatility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Returns&#39;</span><span class="p">]</span>
        <span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="n">horizon</span><span class="p">)</span>
        <span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">horizon</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="p">)</span>
    
    <span class="c1"># 4. Features con ventanas adaptativas</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MA_10&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MA_50&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    
    <span class="c1"># 5. Eliminar solo filas donde el target es NaN</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Future_Volatility&#39;</span><span class="p">])</span>
    
    <span class="c1"># 6. Verificar que hay datos restantes</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;¬°No hay datos v√°lidos despu√©s de la limpieza! Ajusta lookback/horizon&quot;</span><span class="p">)</span>
    
    <span class="c1"># 7. Selecci√≥n final de features</span>
    <span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Returns&#39;</span><span class="p">,</span> <span class="s1">&#39;MA_10&#39;</span><span class="p">,</span> <span class="s1">&#39;MA_50&#39;</span><span class="p">,</span> <span class="s1">&#39;Historical_Volatility&#39;</span><span class="p">,</span> <span class="s1">&#39;Volume&#39;</span><span class="p">]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Future_Volatility&#39;</span><span class="p">]</span>
    
    <span class="c1"># NUEVO: Detectar y eliminar filas con NaN en las features</span>
    <span class="c1"># Identificar filas con valores nulos en cualquier feature</span>
    <span class="n">mask_nan</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mask_nan</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Eliminando </span><span class="si">{</span><span class="n">mask_nan</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2"> filas con valores NaN&quot;</span><span class="p">)</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">~</span><span class="n">mask_nan</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">mask_nan</span><span class="p">]</span>
    
    <span class="c1"># 8. Verificar que a√∫n quedan suficientes datos</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Se necesitan al menos 2 muestras despu√©s de eliminar NaN&quot;</span><span class="p">)</span>
    
    <span class="c1"># 9. Escalado con verificaci√≥n</span>
    <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">X_scaled</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span><span class="p">,</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># 1. Preparar datos (usando la versi√≥n mejorada de la funci√≥n)</span>
<span class="n">X_vol</span><span class="p">,</span> <span class="n">y_vol</span> <span class="o">=</span> <span class="n">prepare_data</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;15m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

<span class="c1"># 2. Divisi√≥n temporal (sin shuffle)</span>
<span class="n">X_train_vol</span><span class="p">,</span> <span class="n">X_test_vol</span><span class="p">,</span> <span class="n">y_train_vol</span><span class="p">,</span> <span class="n">y_test_vol</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_vol</span><span class="p">,</span> 
    <span class="n">y_vol</span><span class="p">,</span>
    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span>  <span class="c1"># Crucial para series temporales</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Eliminando 13 filas con valores NaN
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id9">
<h1>Descripcion de la funcion de Preparacion de Datos<a class="headerlink" href="#id9" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id10">
<h1>K-Nearest Neighbors (KNN)<a class="headerlink" href="#id10" title="Link to this heading">#</a></h1>
<p>Definici√≥n: Modelo de aprendizaje supervisado no param√©trico que clasifica nuevas observaciones bas√°ndose en la mayor√≠a de votos de sus <span class="math notranslate nohighlight">\(k\)</span> vecinos m√°s cercanos en el espacio de caracter√≠sticas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>

<span class="c1"># Modelo KNN para predecir volatilidad</span>

<span class="n">knn_volatility</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">()</span>
<span class="n">grid_knn_volatility</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">knn_volatility</span><span class="p">,</span> <span class="n">params_knn</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">grid_knn_volatility</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_vol</span><span class="p">,</span> <span class="n">y_train_vol</span><span class="p">)</span>
<span class="n">best_knn_volatility</span> <span class="o">=</span> <span class="n">grid_knn_volatility</span><span class="o">.</span><span class="n">best_estimator_</span>
</pre></div>
</div>
</div>
</div>
<section id="id11">
<h2>Algoritmo de Optimizacion<a class="headerlink" href="#id11" title="Link to this heading">#</a></h2>
<section id="id12">
<h3>KNN ‚Üí KD-Trees, Ball Trees, FAISS.<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">faiss</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>

<span class="c1"># Modelos KNN con diferentes algoritmos</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;KNN (KD-Tree)&quot;</span><span class="p">:</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;kd_tree&#39;</span><span class="p">),</span>
    <span class="s2">&quot;KNN (Ball Tree)&quot;</span><span class="p">:</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ball_tree&#39;</span><span class="p">),</span>
<span class="p">}</span>

<span class="c1"># Dimensi√≥n de las caracter√≠sticas</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">X_train_vol</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Crear un √≠ndice FAISS para b√∫squeda de vecinos m√°s cercanos</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">faiss</span><span class="o">.</span><span class="n">IndexFlatL2</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  <span class="c1"># √çndice L2 (distancia euclidiana)</span>
<span class="n">faiss_index</span> <span class="o">=</span> <span class="n">faiss</span><span class="o">.</span><span class="n">IndexIDMap</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Convertir datos a float32 para FAISS</span>
<span class="n">X_train_faiss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">X_train_vol</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">))</span>
<span class="n">faiss_index</span><span class="o">.</span><span class="n">add_with_ids</span><span class="p">(</span><span class="n">X_train_faiss</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">X_train_faiss</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="c1"># Medici√≥n de tiempos de entrenamiento y predicci√≥n</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_vol</span><span class="p">,</span> <span class="n">y_train_vol</span><span class="p">)</span>
    <span class="n">train_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_vol</span><span class="p">)</span>
    <span class="n">pred_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">train_time</span><span class="p">,</span> <span class="n">pred_time</span><span class="p">))</span>

<span class="c1"># Medir tiempo de predicci√≥n con FAISS</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># N√∫mero de vecinos</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">D</span><span class="p">,</span> <span class="n">I</span> <span class="o">=</span> <span class="n">faiss_index</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">X_test_vol</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)),</span> <span class="n">k</span><span class="p">)</span>
<span class="n">pred_time_faiss</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s2">&quot;KNN (FAISS)&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A (√çndice preconstruido)&quot;</span><span class="p">,</span> <span class="n">pred_time_faiss</span><span class="p">))</span>

<span class="c1"># Mostrar resultados</span>
<span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">train_time</span><span class="p">,</span> <span class="n">pred_time</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">: Entrenamiento = </span><span class="si">{</span><span class="n">train_time</span><span class="si">}</span><span class="s2"> s, Predicci√≥n = </span><span class="si">{</span><span class="n">pred_time</span><span class="si">}</span><span class="s2"> s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id13">
<h1>Clasificador Naive Bayes<a class="headerlink" href="#id13" title="Link to this heading">#</a></h1>
<section id="id14">
<h2>Definici√≥n: Basado en el teorema de Bayes, asume independencia entre caracter√≠sticas (naive) para calcular probabilidades de pertenencia a cada clase.<a class="headerlink" href="#id14" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">BayesianRidge</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>


<span class="c1"># Bayesian Ridge para datos de 15m</span>
<span class="n">bayes_ridge_15m</span> <span class="o">=</span> <span class="n">BayesianRidge</span><span class="p">()</span>
<span class="n">bayes_ridge_15m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_vol</span><span class="p">,</span> <span class="n">y_train_vol</span><span class="p">)</span>

<span class="c1"># Predicci√≥n en el conjunto de prueba</span>
<span class="n">y_pred_vol</span> <span class="o">=</span> <span class="n">bayes_ridge_15m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_vol</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id15">
<h2>Algoritmo de Optimizacion<a class="headerlink" href="#id15" title="Link to this heading">#</a></h2>
<section id="id16">
<h3>Naive Bayes ‚Üí partial_fit() para entrenamiento por lotes.<a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">BayesianRidge</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Bayesian Ridge para datos de 15m (Ajuste completo)</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">bayes_ridge_15m</span> <span class="o">=</span> <span class="n">BayesianRidge</span><span class="p">()</span>
<span class="n">bayes_ridge_15m</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_vol</span><span class="p">,</span> <span class="n">y_train_vol</span><span class="p">)</span>  <span class="c1"># Variables cambiadas aqu√≠</span>
<span class="n">std_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="c1"># Bayesian Ridge con entrenamiento en lotes</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">bayes_ridge_online</span> <span class="o">=</span> <span class="n">BayesianRidge</span><span class="p">()</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train_vol</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">):</span>  <span class="c1"># Variable cambiada aqu√≠</span>
    <span class="n">X_batch</span> <span class="o">=</span> <span class="n">X_train_vol</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">batch_size</span><span class="p">]</span>  <span class="c1"># Variable cambiada aqu√≠</span>
    <span class="n">y_batch</span> <span class="o">=</span> <span class="n">y_train_vol</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">batch_size</span><span class="p">]</span>  <span class="c1"># Variable cambiada aqu√≠</span>
    <span class="n">bayes_ridge_online</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_batch</span><span class="p">,</span> <span class="n">y_batch</span><span class="p">)</span>
<span class="n">online_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tiempos Bayesian Ridge:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Fit completo: </span><span class="si">{</span><span class="n">std_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Fit en lotes (batch=</span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">online_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>

<span class="c1"># Predicci√≥n en el conjunto de prueba (esta parte se agreg√≥ para coincidir con tu segundo bloque)</span>
<span class="n">y_pred_vol</span> <span class="o">=</span> <span class="n">bayes_ridge_15m</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_vol</span><span class="p">)</span>  <span class="c1"># Variable cambiada aqu√≠</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tiempos Bayesian Ridge:
- Fit completo: 0.0492s
- Fit en lotes (batch=100): 3.4747s
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id17">
<h1>Regresi√≥n Log√≠stica (con regularizaci√≥n L1/L2)<a class="headerlink" href="#id17" title="Link to this heading">#</a></h1>
<section id="id18">
<h2>Definici√≥n: Modelo lineal para clasificaci√≥n binaria que transforma una combinaci√≥n lineal de inputs mediante la funci√≥n sigmoide para estimar probabilidades.<a class="headerlink" href="#id18" title="Link to this heading">#</a></h2>
</section>
<section id="id19">
<h2>Ridge Regression<a class="headerlink" href="#id19" title="Link to this heading">#</a></h2>
<section id="id20">
<h3>Definici√≥n: T√©cnica de regularizaci√≥n L2 para modelos lineales que penaliza los coeficientes grandes para reducir sobreajuste.<a class="headerlink" href="#id20" title="Link to this heading">#</a></h3>
</section>
</section>
<section id="id21">
<h2>Lasso Regression<a class="headerlink" href="#id21" title="Link to this heading">#</a></h2>
<section id="id22">
<h3>Definici√≥n: T√©cnica de regularizaci√≥n L1 que no solo previene sobreajuste sino que tambi√©n realiza selecci√≥n de caracter√≠sticas al forzar coeficientes a cero.<a class="headerlink" href="#id22" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">LassoCV</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Ridge optimizado con solver &#39;saga&#39;</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">saga_ridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;saga&#39;</span><span class="p">)</span>
<span class="n">saga_ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_vol</span><span class="p">,</span> <span class="n">y_train_vol</span><span class="p">)</span>  <span class="c1"># Variables modificadas aqu√≠</span>
<span class="n">saga_ridge_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="c1"># Lasso optimizado con selecci√≥n autom√°tica de alpha</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">lasso_cv</span> <span class="o">=</span> <span class="n">LassoCV</span><span class="p">(</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">lasso_cv</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_vol</span><span class="p">,</span> <span class="n">y_train_vol</span><span class="p">)</span>  <span class="c1"># Variables modificadas aqu√≠</span>
<span class="n">lasso_cv_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tiempos con optimizaci√≥n:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Ridge (SAGA): </span><span class="si">{</span><span class="n">saga_ridge_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Lasso (CV, selecci√≥n de alpha): </span><span class="si">{</span><span class="n">lasso_cv_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Mejor alpha para Lasso: </span><span class="si">{</span><span class="n">lasso_cv</span><span class="o">.</span><span class="n">alpha_</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\mcvar\anaconda3\envs\ml_venv\lib\site-packages\sklearn\linear_model\_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tiempos con optimizaci√≥n:
- Ridge (SAGA): 76.1480s
- Lasso (CV, selecci√≥n de alpha): 1.7470s
- Mejor alpha para Lasso: 0.0003
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id23">
<h1>ALgoritmo de Optimizacion<a class="headerlink" href="#id23" title="Link to this heading">#</a></h1>
<section id="id24">
<h2>Ridge/Lasso ‚Üí Solver optimizado saga.<a class="headerlink" href="#id24" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Ridge optimizado con solver &#39;saga&#39;</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">saga_ridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;saga&#39;</span><span class="p">)</span>
<span class="n">saga_ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_vol</span><span class="p">,</span> <span class="n">y_train_vol</span><span class="p">)</span>  <span class="c1"># Variables modificadas</span>
<span class="n">saga_ridge_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="c1"># Lasso optimizado con solver &#39;saga&#39;</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">saga_lasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">saga_lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_vol</span><span class="p">,</span> <span class="n">y_train_vol</span><span class="p">)</span>  <span class="c1"># Variables modificadas</span>
<span class="n">saga_lasso_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tiempos con optimizaci√≥n SAGA:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Ridge (SAGA): </span><span class="si">{</span><span class="n">saga_ridge_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Lasso (SAGA): </span><span class="si">{</span><span class="n">saga_lasso_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tiempos con optimizaci√≥n SAGA:
- Ridge (SAGA): 73.7822s
- Lasso (SAGA): 0.0190s
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\mcvar\anaconda3\envs\ml_venv\lib\site-packages\sklearn\linear_model\_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id25">
<h1>Decision Tree<a class="headerlink" href="#id25" title="Link to this heading">#</a></h1>
<section id="id26">
<h2>Definici√≥n: Modelo de aprendizaje supervisado que divide recursivamente el espacio de caracter√≠sticas mediante reglas de decisi√≥n binarias.<a class="headerlink" href="#id26" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>

<span class="c1"># √Årbol de decisi√≥n para datos de 15m (Regresi√≥n)</span>
<span class="n">tree_vol</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># Nombre ajustado opcional</span>
<span class="n">tree_vol</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_vol</span><span class="p">,</span> <span class="n">y_train_vol</span><span class="p">)</span>  <span class="c1"># Variables modificadas aqu√≠</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-7 {color: black;}#sk-container-id-7 pre{padding: 0;}#sk-container-id-7 div.sk-toggleable {background-color: white;}#sk-container-id-7 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-7 label.sk-toggleable__label-arrow:before {content: "‚ñ∏";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-7 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-7 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-7 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-7 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-7 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-7 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "‚ñæ";}#sk-container-id-7 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-7 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-7 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-7 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-7 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-7 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-7 div.sk-item {position: relative;z-index: 1;}#sk-container-id-7 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-7 div.sk-item::before, #sk-container-id-7 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-7 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-7 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-7 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-7 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-7 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-7 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-7 div.sk-label-container {text-align: center;}#sk-container-id-7 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-7 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-7" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>DecisionTreeRegressor(max_depth=5)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-9" type="checkbox" checked><label for="sk-estimator-id-9" class="sk-toggleable__label sk-toggleable__label-arrow">DecisionTreeRegressor</label><div class="sk-toggleable__content"><pre>DecisionTreeRegressor(max_depth=5)</pre></div></div></div></div></div></div></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id27">
<h1>Random Forest<a class="headerlink" href="#id27" title="Link to this heading">#</a></h1>
<section id="id28">
<h2>Definici√≥n: M√©todo de ensemble que combina m√∫ltiples √°rboles de decisi√≥n entrenados en subconjuntos aleatorios de datos y caracter√≠sticas.<a class="headerlink" href="#id28" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>

<span class="c1"># Random Forest para datos de volumen (Regresi√≥n)</span>
<span class="n">rf_vol</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># Nombre ajustado</span>
<span class="n">rf_vol</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_vol</span><span class="p">,</span> <span class="n">y_train_vol</span><span class="p">)</span>  <span class="c1"># Variables modificadas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-8 {color: black;}#sk-container-id-8 pre{padding: 0;}#sk-container-id-8 div.sk-toggleable {background-color: white;}#sk-container-id-8 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-8 label.sk-toggleable__label-arrow:before {content: "‚ñ∏";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-8 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-8 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-8 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-8 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-8 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-8 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "‚ñæ";}#sk-container-id-8 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-8 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-8 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-8 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-8 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-8 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-8 div.sk-item {position: relative;z-index: 1;}#sk-container-id-8 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-8 div.sk-item::before, #sk-container-id-8 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-8 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-8 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-8 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-8 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-8 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-8 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-8 div.sk-label-container {text-align: center;}#sk-container-id-8 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-8 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-8" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomForestRegressor(max_depth=5, random_state=42)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-10" type="checkbox" checked><label for="sk-estimator-id-10" class="sk-toggleable__label sk-toggleable__label-arrow">RandomForestRegressor</label><div class="sk-toggleable__content"><pre>RandomForestRegressor(max_depth=5, random_state=42)</pre></div></div></div></div></div></div></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id29">
<h1>XGBoost<a class="headerlink" href="#id29" title="Link to this heading">#</a></h1>
<section id="id30">
<h2>Definici√≥n: Algoritmo de boosting que combina secuencialmente modelos d√©biles (normalmente √°rboles) corrigiendo los errores de los modelos anteriores.<a class="headerlink" href="#id30" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="nn">xgb</span>

<span class="c1"># XGBoost para datos de volumen (Regresi√≥n)</span>
<span class="n">xgb_vol</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">XGBRegressor</span><span class="p">(</span>  <span class="c1"># Nombre del modelo ajustado</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">tree_method</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span>
    <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
<span class="n">xgb_vol</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">X_train_vol</span><span class="p">,</span>              <span class="c1"># Variable modificada</span>
    <span class="n">y_train_vol</span><span class="p">,</span>              <span class="c1"># Variable modificada</span>
    <span class="n">eval_set</span><span class="o">=</span><span class="p">[(</span><span class="n">X_test_vol</span><span class="p">,</span> <span class="n">y_test_vol</span><span class="p">)],</span>  <span class="c1"># Variables de test modificadas</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-9 {color: black;}#sk-container-id-9 pre{padding: 0;}#sk-container-id-9 div.sk-toggleable {background-color: white;}#sk-container-id-9 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-9 label.sk-toggleable__label-arrow:before {content: "‚ñ∏";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-9 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-9 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-9 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-9 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-9 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-9 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "‚ñæ";}#sk-container-id-9 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-9 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-9 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-9 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-9 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-9 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-9 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-9 div.sk-item {position: relative;z-index: 1;}#sk-container-id-9 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-9 div.sk-item::before, #sk-container-id-9 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-9 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-9 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-9 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-9 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-9 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-9 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-9 div.sk-label-container {text-align: center;}#sk-container-id-9 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-9 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-9" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>XGBRegressor(base_score=None, booster=None, callbacks=None,
             colsample_bylevel=None, colsample_bynode=None,
             colsample_bytree=None, device=None, early_stopping_rounds=10,
             enable_categorical=False, eval_metric=&#x27;rmse&#x27;, feature_types=None,
             gamma=None, grow_policy=None, importance_type=None,
             interaction_constraints=None, learning_rate=None, max_bin=None,
             max_cat_threshold=None, max_cat_to_onehot=None,
             max_delta_step=None, max_depth=3, max_leaves=None,
             min_child_weight=None, missing=nan, monotone_constraints=None,
             multi_strategy=None, n_estimators=100, n_jobs=None,
             num_parallel_tree=None, random_state=42, ...)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-11" type="checkbox" checked><label for="sk-estimator-id-11" class="sk-toggleable__label sk-toggleable__label-arrow">XGBRegressor</label><div class="sk-toggleable__content"><pre>XGBRegressor(base_score=None, booster=None, callbacks=None,
             colsample_bylevel=None, colsample_bynode=None,
             colsample_bytree=None, device=None, early_stopping_rounds=10,
             enable_categorical=False, eval_metric=&#x27;rmse&#x27;, feature_types=None,
             gamma=None, grow_policy=None, importance_type=None,
             interaction_constraints=None, learning_rate=None, max_bin=None,
             max_cat_threshold=None, max_cat_to_onehot=None,
             max_delta_step=None, max_depth=3, max_leaves=None,
             min_child_weight=None, missing=nan, monotone_constraints=None,
             multi_strategy=None, n_estimators=100, n_jobs=None,
             num_parallel_tree=None, random_state=42, ...)</pre></div></div></div></div></div></div></div>
</div>
</section>
<section id="id31">
<h2>Algoritmo de Optimizacion<a class="headerlink" href="#id31" title="Link to this heading">#</a></h2>
<section id="id32">
<h3>XGBoost ‚Üí tree_method=‚Äôhist‚Äô y early_stopping_rounds.<a class="headerlink" href="#id32" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="nn">xgb</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Configuraci√≥n √≥ptima para XGBoost en regresi√≥n</span>
<span class="n">xgb_optimized_vol</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">XGBRegressor</span><span class="p">(</span>  <span class="c1"># Nombre del modelo modificado</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">max_depth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">tree_method</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span>
    <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;rmse&#39;</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># Entrenamiento con medici√≥n de tiempo</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">xgb_optimized_vol</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">X_train_vol</span><span class="p">,</span>              <span class="c1"># Variable modificada</span>
    <span class="n">y_train_vol</span><span class="p">,</span>              <span class="c1"># Variable modificada</span>
    <span class="n">eval_set</span><span class="o">=</span><span class="p">[(</span><span class="n">X_test_vol</span><span class="p">,</span> <span class="n">y_test_vol</span><span class="p">)],</span>  <span class="c1"># Variables de test modificadas</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">10</span>
<span class="p">)</span>
<span class="n">time_vol</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>  <span class="c1"># Variable de tiempo modificada</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tiempos de entrenamiento optimizados:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;15min: </span><span class="si">{</span><span class="n">time_vol</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s (Detenido en </span><span class="si">{</span><span class="n">xgb_optimized_vol</span><span class="o">.</span><span class="n">best_iteration</span><span class="si">}</span><span class="s2"> iteraciones)&quot;</span><span class="p">)</span>  <span class="c1"># Referencia al modelo actualizada</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0]	validation_0-rmse:0.00181
[10]	validation_0-rmse:0.00153
[20]	validation_0-rmse:0.00147
[30]	validation_0-rmse:0.00146
[40]	validation_0-rmse:0.00145
[50]	validation_0-rmse:0.00145
[60]	validation_0-rmse:0.00145
[70]	validation_0-rmse:0.00145
[80]	validation_0-rmse:0.00145
[90]	validation_0-rmse:0.00145
[100]	validation_0-rmse:0.00145
[109]	validation_0-rmse:0.00145

Tiempos de entrenamiento optimizados:
15min: 1.35s (Detenido en 80 iteraciones)
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id33">
<h1>SVM (Support Vector Machines)<a class="headerlink" href="#id33" title="Link to this heading">#</a></h1>
<section id="id34">
<h2>Definici√≥n: Algoritmo que encuentra el hiperplano √≥ptimo en un espacio dimensional alto que maximiza el margen entre clases.<a class="headerlink" href="#id34" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>

<span class="c1"># SVM para datos de volumen (Regresi√≥n)</span>
<span class="n">svm_vol</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>  <span class="c1"># Nombre del modelo modificado</span>
<span class="n">svm_vol</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_vol</span><span class="p">,</span> <span class="n">y_train_vol</span><span class="p">)</span>  <span class="c1"># Variables modificadas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-10 {color: black;}#sk-container-id-10 pre{padding: 0;}#sk-container-id-10 div.sk-toggleable {background-color: white;}#sk-container-id-10 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-10 label.sk-toggleable__label-arrow:before {content: "‚ñ∏";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-10 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-10 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-10 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-10 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-10 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-10 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "‚ñæ";}#sk-container-id-10 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-10 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-10 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-10 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-10 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-10 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-10 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-10 div.sk-item {position: relative;z-index: 1;}#sk-container-id-10 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-10 div.sk-item::before, #sk-container-id-10 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-10 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-10 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-10 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-10 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-10 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-10 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-10 div.sk-label-container {text-align: center;}#sk-container-id-10 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-10 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-10" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>SVR()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-12" type="checkbox" checked><label for="sk-estimator-id-12" class="sk-toggleable__label sk-toggleable__label-arrow">SVR</label><div class="sk-toggleable__content"><pre>SVR()</pre></div></div></div></div></div></div></div>
</div>
</section>
<section id="id35">
<h2>Algoritmo de optimizacion<a class="headerlink" href="#id35" title="Link to this heading">#</a></h2>
<section id="id36">
<h3>LinearSVC en vez de SVC(kernel=‚Äôlinear‚Äô), RBF con Random Fourier Features<a class="headerlink" href="#id36" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">LinearSVR</span><span class="p">,</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.kernel_approximation</span> <span class="kn">import</span> <span class="n">RBFSampler</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>

<span class="c1"># 1. LinearSVR (SVM sin kernel para regresi√≥n)</span>
<span class="n">linear_svr_vol</span> <span class="o">=</span> <span class="n">LinearSVR</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>  <span class="c1"># Nombre modificado</span>
<span class="n">linear_svr_vol</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_vol</span><span class="p">,</span> <span class="n">y_train_vol</span><span class="p">)</span>  <span class="c1"># Variables ajustadas</span>

<span class="c1"># 2. SGDRegressor (SVM optimizado con SGD)</span>
<span class="n">sgd_svr_vol</span> <span class="o">=</span> <span class="n">SGDRegressor</span><span class="p">(</span>  <span class="c1"># Nombre modificado</span>
    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> 
    <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> 
    <span class="n">learning_rate</span><span class="o">=</span><span class="s1">&#39;adaptive&#39;</span><span class="p">,</span> 
    <span class="n">eta0</span><span class="o">=</span><span class="mf">0.01</span>
<span class="p">)</span>
<span class="n">sgd_svr_vol</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_vol</span><span class="p">,</span> <span class="n">y_train_vol</span><span class="p">)</span>  <span class="c1"># Variables ajustadas</span>

<span class="c1"># 3. Kernel RBF con aproximaci√≥n eficiente</span>
<span class="n">rbf_svr_vol</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>  <span class="c1"># Nombre modificado</span>
    <span class="n">RBFSampler</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span> 
    <span class="n">SGDRegressor</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">rbf_svr_vol</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_vol</span><span class="p">,</span> <span class="n">y_train_vol</span><span class="p">)</span>  <span class="c1"># Variables ajustadas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">8</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="c1"># 1. LinearSVR (SVM sin kernel para regresi√≥n)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">linear_svr_vol</span> <span class="o">=</span> <span class="n">LinearSVR</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>  <span class="c1"># Nombre modificado</span>
<span class="ne">----&gt; </span><span class="mi">8</span> <span class="n">linear_svr_vol</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_vol</span><span class="p">,</span> <span class="n">y_train_vol</span><span class="p">)</span>  <span class="c1"># Variables ajustadas</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="c1"># 2. SGDRegressor (SVM optimizado con SGD)</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="n">sgd_svr_vol</span> <span class="o">=</span> <span class="n">SGDRegressor</span><span class="p">(</span>  <span class="c1"># Nombre modificado</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>     <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> 
<span class="g g-Whitespace">     </span><span class="mi">13</span>     <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> 
<span class="g g-Whitespace">     </span><span class="mi">14</span>     <span class="n">learning_rate</span><span class="o">=</span><span class="s1">&#39;adaptive&#39;</span><span class="p">,</span> 
<span class="g g-Whitespace">     </span><span class="mi">15</span>     <span class="n">eta0</span><span class="o">=</span><span class="mf">0.01</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span> <span class="p">)</span>

<span class="ne">NameError</span>: name &#39;X_train_vol&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id37">
<h1>Resultados<a class="headerlink" href="#id37" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.stattools</span> <span class="kn">import</span> <span class="n">jarque_bera</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">SGDRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>

<span class="c1"># Modelos optimizados de regresi√≥n</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;KNN (KD-Tree)&quot;</span><span class="p">:</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;kd_tree&#39;</span><span class="p">),</span>
    <span class="s2">&quot;Ridge (SAGA)&quot;</span><span class="p">:</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;saga&#39;</span><span class="p">),</span>
    <span class="s2">&quot;Lasso (SAGA)&quot;</span><span class="p">:</span> <span class="n">Lasso</span><span class="p">(),</span>
    <span class="s2">&quot;XGBoost (hist)&quot;</span><span class="p">:</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">tree_method</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">),</span>
    <span class="s2">&quot;SGD Regressor&quot;</span><span class="p">:</span> <span class="n">SGDRegressor</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;squared_error&#39;</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">),</span>
    <span class="s2">&quot;SVM (RBF Kernel)&quot;</span><span class="p">:</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">residuals_dict</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="c1"># Entrenamiento con variables modificadas</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_vol</span><span class="p">,</span> <span class="n">y_train_vol</span><span class="p">)</span>  <span class="c1"># Variables ajustadas aqu√≠</span>
    <span class="n">train_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

    <span class="c1"># Predicci√≥n con variables modificadas</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_vol</span><span class="p">)</span>  <span class="c1"># Variable ajustada aqu√≠</span>
    <span class="n">pred_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

    <span class="c1"># C√°lculo de residuos con variables modificadas</span>
    <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_test_vol</span> <span class="o">-</span> <span class="n">y_pred</span>  <span class="c1"># Variable ajustada aqu√≠</span>
    <span class="n">residuals_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">residuals</span>

    <span class="c1"># M√©tricas con variables modificadas</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test_vol</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>  <span class="c1"># Ajustada</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test_vol</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>  <span class="c1"># Ajustada</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test_vol</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>  <span class="c1"># Ajustada</span>

    <span class="c1"># Pruebas estad√≠sticas (se mantienen igual)</span>
    <span class="n">ljung_box_p</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s2">&quot;lb_pvalue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">jb_p</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuals</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;Modelo&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
        <span class="s2">&quot;Tiempo Entrenamiento&quot;</span><span class="p">:</span> <span class="n">train_time</span><span class="p">,</span>
        <span class="s2">&quot;Tiempo Predicci√≥n&quot;</span><span class="p">:</span> <span class="n">pred_time</span><span class="p">,</span>
        <span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s2">&quot;R¬≤&quot;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s2">&quot;Ljung-Box p-value&quot;</span><span class="p">:</span> <span class="n">ljung_box_p</span><span class="p">,</span>
        <span class="s2">&quot;Jarque-Bera p-value&quot;</span><span class="p">:</span> <span class="n">jb_p</span>
    <span class="p">})</span>

<span class="c1"># Resultados comparativos (se mantiene igual)</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;R¬≤&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># Gr√°ficos (se mantienen igual)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">residuals</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">residuals_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">plot_acf</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ACF de los Residuos - </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Histograma de los Residuos - </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\mcvar\anaconda3\envs\ml_venv\lib\site-packages\sklearn\linear_model\_sag.py:350: ConvergenceWarning: The max_iter was reached which means the coef_ did not converge
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>             Modelo  Tiempo Entrenamiento  Tiempo Predicci√≥n       MAPE  \
4     SGD Regressor              0.236847           0.001000   0.701601   
1      Ridge (SAGA)             82.120407           0.001002   0.692843   
0     KNN (KD-Tree)              0.386624           0.998042   0.872162   
3    XGBoost (hist)              0.601347           0.024004   1.005562   
2      Lasso (SAGA)              0.020582           0.001014   1.291530   
5  SVM (RBF Kernel)              0.066040           0.004996  49.713398   

       RMSE           R¬≤  Ljung-Box p-value  Jarque-Bera p-value  
4  0.001513     0.205823                0.0                  0.0  
1  0.001519     0.199368                0.0                  0.0  
0  0.001689     0.010442                0.0                  0.0  
3  0.001772    -0.089052                0.0                  0.0  
2  0.001876    -0.220179                0.0                  0.0  
5  0.066164 -1517.025419                0.0                  0.0  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\mcvar\anaconda3\envs\ml_venv\lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
c:\Users\mcvar\anaconda3\envs\ml_venv\lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
c:\Users\mcvar\anaconda3\envs\ml_venv\lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
c:\Users\mcvar\anaconda3\envs\ml_venv\lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
c:\Users\mcvar\anaconda3\envs\ml_venv\lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
c:\Users\mcvar\anaconda3\envs\ml_venv\lib\site-packages\seaborn\_oldcore.py:1119: FutureWarning: use_inf_as_na option is deprecated and will be removed in a future version. Convert inf values to NaN before operating instead.
  with pd.option_context(&#39;mode.use_inf_as_na&#39;, True):
</pre></div>
</div>
<img alt="_images/c90147e6040e83650a7899a8e08e7f3f6acc274e998a7a3860efff971c9f3183.png" src="_images/c90147e6040e83650a7899a8e08e7f3f6acc274e998a7a3860efff971c9f3183.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Modelos%20Home%20Credit.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Evaluaci√≥n de Modelos - Home Credit Default Risk</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">AN√ÅLISIS SERIES DE TIEMPO DE BITCOIN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#que-es-bitcoin">¬øQu√© es BITCOIN?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descripcion-de-los-datos">Descripci√≥n de los datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objetivo-del-analisis">Objetivo del an√°lisis</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-datos-bitcoin">An√°lisis exploratorio de datos - BITCOIN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-preliminar">An√°lisis preliminar</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-la-serie">Visualizaci√≥n de la serie</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-temporal">Visualizaci√≥n temporal</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-la-volatilidad-intradia">An√°lisis de la volatilidad intrad√≠a</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-del-precio-de-cierre-y-volumen-de-bitcoin">Interpretaci√≥n del Precio de Cierre y Volumen de Bitcoin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-estacionalidad-y-periodicidad-frecuencia-1-dia">An√°lisis de Estacionalidad y Periodicidad (Frecuencia: 1 d√≠a)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-de-anomalias">Detecci√≥n de Anomal√≠as</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-autocorrelacion">An√°lisis de autocorrelaci√≥n</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-tendencia">An√°lisis de tendencia</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-estacionaridad">An√°lisis de Estacionaridad</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformacion-de-datos">Transformaci√≥n de datos</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones-finales">Conclusiones finales</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-de-modelos-benchmark">Implementaci√≥n de Modelos Benchmark</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-prediccion-del-precio">Modelos Prediccion del Precio</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descripcion-de-la-funcion-de-preparacion-de-datos">Descripci√≥n de la Funci√≥n de Preparaci√≥n de Datos</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#k-nearest-neighbors-knn">K-Nearest Neighbors (KNN)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-resultados-del-modelo-knn-15m">An√°lisis de Resultados del Modelo KNN (15m)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#precio-real-vs-predicho">Precio Real vs. Predicho</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autocorrelacion-de-los-residuos-acf">Autocorrelaci√≥n de los Residuos (ACF)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histograma-de-los-residuos">Histograma de los Residuos</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algoritmo-de-optimizacion">Algoritmo de Optimizacion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#knn-kd-trees-ball-trees-faiss">KNN ‚Üí KD-Trees, Ball Trees, FAISS.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificador-naive-bayes">Clasificador Naive Bayes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-basado-en-el-teorema-de-bayes-asume-independencia-entre-caracteristicas-naive-para-calcular-probabilidades-de-pertenencia-a-cada-clase">Definici√≥n: Basado en el teorema de Bayes, asume independencia entre caracter√≠sticas (naive) para calcular probabilidades de pertenencia a cada clase.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-del-modelo-bayesian-ridge-15m">An√°lisis del Modelo Bayesian Ridge (15m)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-evaluacion">M√©tricas de Evaluaci√≥n</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion">Interpretaci√≥n:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graficos-de-evaluacion">Gr√°ficos de Evaluaci√≥n</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-y-siguientes-pasos">Conclusi√≥n y Siguientes Pasos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Algoritmo de Optimizacion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#naive-bayes-partial-fit-para-entrenamiento-por-lotes">Naive Bayes ‚Üí partial_fit() para entrenamiento por lotes.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-logistica-con-regularizacion-l1-l2">Regresi√≥n Log√≠stica (con regularizaci√≥n L1/L2)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-modelo-lineal-para-clasificacion-binaria-que-transforma-una-combinacion-lineal-de-inputs-mediante-la-funcion-sigmoide-para-estimar-probabilidades">Definici√≥n: Modelo lineal para clasificaci√≥n binaria que transforma una combinaci√≥n lineal de inputs mediante la funci√≥n sigmoide para estimar probabilidades.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ridge-regression">Ridge Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-tecnica-de-regularizacion-l2-para-modelos-lineales-que-penaliza-los-coeficientes-grandes-para-reducir-sobreajuste">Definici√≥n: T√©cnica de regularizaci√≥n L2 para modelos lineales que penaliza los coeficientes grandes para reducir sobreajuste.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lasso-regression">Lasso Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-tecnica-de-regularizacion-l1-que-no-solo-previene-sobreajuste-sino-que-tambien-realiza-seleccion-de-caracteristicas-al-forzar-coeficientes-a-cero">Definici√≥n: T√©cnica de regularizaci√≥n L1 que no solo previene sobreajuste sino que tambi√©n realiza selecci√≥n de caracter√≠sticas al forzar coeficientes a cero.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-optimizacion-ridge-vs-lasso">An√°lisis de Optimizaci√≥n: Ridge vs. Lasso</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-de-tiempos-de-entrenamiento">Comparaci√≥n de Tiempos de Entrenamiento</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Interpretaci√≥n:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-resultados-modelos-ridge-saga-vs-lasso-cv">An√°lisis de Resultados: Modelos Ridge (SAGA) vs Lasso (CV)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-de-rendimiento">M√©tricas de Rendimiento</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-resultados">Interpretaci√≥n de Resultados</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#precision-predictiva">Precisi√≥n Predictiva</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-residuos">An√°lisis de Residuos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ajuste-a-los-datos">Ajuste a los Datos</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones">Conclusiones</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">ALgoritmo de Optimizacion</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ridge-lasso-solver-optimizado-saga">Ridge/Lasso ‚Üí Solver optimizado saga.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-la-optimizacion-con-saga">An√°lisis de la Optimizaci√≥n con SAGA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observaciones">Observaciones</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#decision-tree">Decision Tree</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-modelo-de-aprendizaje-supervisado-que-divide-recursivamente-el-espacio-de-caracteristicas-mediante-reglas-de-decision-binarias">Definici√≥n: Modelo de aprendizaje supervisado que divide recursivamente el espacio de caracter√≠sticas mediante reglas de decisi√≥n binarias.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-del-modelo-decision-tree-15m">An√°lisis del Modelo Decision Tree (15m)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuracion-del-modelo">Configuraci√≥n del modelo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">M√©tricas de Evaluaci√≥n</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-los-graficos">An√°lisis de los gr√°ficos</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest">Random Forest</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-metodo-de-ensemble-que-combina-multiples-arboles-de-decision-entrenados-en-subconjuntos-aleatorios-de-datos-y-caracteristicas">Definici√≥n: M√©todo de ensemble que combina m√∫ltiples √°rboles de decisi√≥n entrenados en subconjuntos aleatorios de datos y caracter√≠sticas.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-del-modelo-random-forest-rf">An√°lisis del modelo Random Forest (RF)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-del-modelo"><strong>M√©tricas del modelo</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-las-graficas"><strong>Interpretaci√≥n de las gr√°ficas</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#precio-real-vs-predicho-grafico-de-la-izquierda"><strong>1. Precio Real vs. Predicho</strong> (Gr√°fico de la izquierda)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#acf-de-los-residuos-grafico-del-centro"><strong>2. ACF de los residuos</strong> (Gr√°fico del centro)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#histograma-de-los-residuos-grafico-de-la-derecha"><strong>3. Histograma de los residuos</strong> (Gr√°fico de la derecha)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion"><strong>Conclusi√≥n</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost">XGBoost</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-algoritmo-de-boosting-que-combina-secuencialmente-modelos-debiles-normalmente-arboles-corrigiendo-los-errores-de-los-modelos-anteriores">Definici√≥n: Algoritmo de boosting que combina secuencialmente modelos d√©biles (normalmente √°rboles) corrigiendo los errores de los modelos anteriores.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluacion-del-modelo-xgboost">Evaluaci√≥n del Modelo XGBoost</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-con-otros-modelos">Comparaci√≥n con otros modelos</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Algoritmo de Optimizacion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost-tree-method-hist-y-early-stopping-rounds">XGBoost ‚Üí tree_method=‚Äôhist‚Äô y early_stopping_rounds.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Conclusiones</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost-optimizado">XGBoost Optimizado</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#svm-support-vector-machines">SVM (Support Vector Machines)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definicion-algoritmo-que-encuentra-el-hiperplano-optimo-en-un-espacio-dimensional-alto-que-maximiza-el-margen-entre-clases">Definici√≥n: Algoritmo que encuentra el hiperplano √≥ptimo en un espacio dimensional alto que maximiza el margen entre clases.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Algoritmo de optimizacion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linearsvc-en-vez-de-svc-kernel-linear-rbf-con-random-fourier-features">LinearSVC en vez de SVC(kernel=‚Äôlinear‚Äô), RBF con Random Fourier Features</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados">Resultados</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-comparativo-de-modelos-de-regresion">An√°lisis Comparativo de Modelos de Regresi√≥n</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen-de-rendimiento">Resumen de Rendimiento</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#precision-predictiva-ordenados-de-mejor-a-peor">Precisi√≥n Predictiva (ordenados de mejor a peor)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eficiencia-computacional">Eficiencia Computacional</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">An√°lisis de Residuos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autocorrelacion-acf">Autocorrelaci√≥n (ACF)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distribucion-de-residuos">Distribuci√≥n de Residuos</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones-clave">Conclusiones Clave</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-para-volatilidad">Modelos para Volatilidad</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Descripcion de la funcion de Preparacion de Datos</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">K-Nearest Neighbors (KNN)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Algoritmo de Optimizacion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">KNN ‚Üí KD-Trees, Ball Trees, FAISS.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Clasificador Naive Bayes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Definici√≥n: Basado en el teorema de Bayes, asume independencia entre caracter√≠sticas (naive) para calcular probabilidades de pertenencia a cada clase.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Algoritmo de Optimizacion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Naive Bayes ‚Üí partial_fit() para entrenamiento por lotes.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Regresi√≥n Log√≠stica (con regularizaci√≥n L1/L2)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Definici√≥n: Modelo lineal para clasificaci√≥n binaria que transforma una combinaci√≥n lineal de inputs mediante la funci√≥n sigmoide para estimar probabilidades.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Ridge Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Definici√≥n: T√©cnica de regularizaci√≥n L2 para modelos lineales que penaliza los coeficientes grandes para reducir sobreajuste.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Lasso Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Definici√≥n: T√©cnica de regularizaci√≥n L1 que no solo previene sobreajuste sino que tambi√©n realiza selecci√≥n de caracter√≠sticas al forzar coeficientes a cero.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">ALgoritmo de Optimizacion</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Ridge/Lasso ‚Üí Solver optimizado saga.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">Decision Tree</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">Definici√≥n: Modelo de aprendizaje supervisado que divide recursivamente el espacio de caracter√≠sticas mediante reglas de decisi√≥n binarias.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">Random Forest</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">Definici√≥n: M√©todo de ensemble que combina m√∫ltiples √°rboles de decisi√≥n entrenados en subconjuntos aleatorios de datos y caracter√≠sticas.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">XGBoost</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">Definici√≥n: Algoritmo de boosting que combina secuencialmente modelos d√©biles (normalmente √°rboles) corrigiendo los errores de los modelos anteriores.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">Algoritmo de Optimizacion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">XGBoost ‚Üí tree_method=‚Äôhist‚Äô y early_stopping_rounds.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">SVM (Support Vector Machines)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id34">Definici√≥n: Algoritmo que encuentra el hiperplano √≥ptimo en un espacio dimensional alto que maximiza el margen entre clases.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id35">Algoritmo de optimizacion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id36">LinearSVC en vez de SVC(kernel=‚Äôlinear‚Äô), RBF con Random Fourier Features</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id37">Resultados</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Eliana Fuentes, Nicol√°s Rodriguez y Maria Camila Vargas
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>¬© 2024 Eliana Fuentes, Nicol√°s Rodriguez y Maria Camila Vargas</p>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>